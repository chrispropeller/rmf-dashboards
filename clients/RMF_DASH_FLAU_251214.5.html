<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Flaus Inc - RMF Dashboard v251214.5</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f5f5f5; }
    
    @media print {
      body { background: white; margin: 0; padding: 0; }
      .no-print { display: none !important; }
      .print-page { page-break-after: always; page-break-inside: avoid; }
      .print-page:last-child { page-break-after: avoid; }
      .print-footer { page-break-before: avoid; page-break-inside: avoid; margin-top: 0; }
      .print-header { page-break-after: avoid; }
      .print-metrics { page-break-after: avoid; page-break-inside: avoid; }
      * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
      
      /* Prevent orphan blank pages */
      html, body { height: auto; }
    }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    // ============================================================================
    // CONSTANTS
    // ============================================================================
    const TEAL = '#1E4D5C';
    const GOLD = '#C9A227';
    const LIGHT_TEAL = '#E8F0F2';
    const GREEN = '#2E7D32';
    const RED = '#C62828';
    const AMBER = '#F59E0B';
    const LIGHT_GREEN = '#E8F5E9';
    const LIGHT_AMBER = '#FFF8E1';

    // Company Data (Q2 2025 Annualized from Benchmark File)
    const COMPANY = {
      name: 'Flaus',
      fullName: 'Flaus, Inc.',
      milestone: '$15M',
      analysisDate: 'December 12, 2024',
      
      // P&L Metrics (annualized, $K)
      grossRevenue: 14776,
      discounts: 1126,
      tradeDeductions: 72,
      netRevenue: 13579,
      cogs: 4634,
      grossProfit: 8944,
      totalOpex: 7345,
      ga: 617,
      sm: 5120,
      operations: 1608,
      ebitda: 1807,
      netIncome: 1430,
      
      // OpEx by Priority
      payroll: 518,
      customerAcquisition: 4831,
      otherOpex: 1996,
      
      // Percentages
      grossRevenuePct: 108.8,
      discountsPct: 8.3,
      tradeDeductionsPct: 0.5,
      grossMarginPct: 65.9,
      gaPct: 4.5,
      smPct: 37.7,
      operationsPct: 11.8,
      ebitdaPct: 13.3,
      netIncomePct: 10.5,
      payrollPct: 3.8,
      cacPct: 35.6,
      otherOpexPct: 14.7,
      
      // Growth
      qoqGrowth: 3.7,
      yoyGrowth: 75.8,
      
      // Capital
      capitalRaised: 4600,
      capitalDeployed: 1600,
      capitalEfficiency: 3.0,  // TODO: Update when cohort methodology confirmed
      growthEfficiencyT12M: -7.3,
      
      // Marketing Efficiency
      paidMedia: 4831,
      totalMarketing: 5120,
      gMER: 2.81,  // Revenue / Paid Media
      MER: 2.65,   // Revenue / Total Marketing
      pMER: 1.75,  // Gross Profit / Total Marketing
      
      // Time
      monthsToMilestone: 18,
    };

    // Cohort Data ($15M Extraordinary Cohort)
    const COHORT = {
      grossRevenuePct: 113.1,
      discountsPct: 13.1,
      tradeDeductionsPct: 0.0,
      grossMarginPct: 67.8,
      gaPct: 25.5,
      smPct: 32.9,
      operationsPct: 5.1,
      ebitdaPct: 4.2,
      otherExpensesPct: 1.0,
      netIncomePct: 5.3,
      payrollPct: 17.2,
      cacPct: 8.0,
      otherOpexPct: 38.2,
      
      qoqGrowth: 30.8,
      yoyGrowth: 246.0,
      
      capitalRaised: 3900,
      capitalDeployed: 3100,
      capitalEfficiency: 4.1,  // TODO: Update when cohort methodology confirmed
      growthEfficiencyT12M: 0.6,
      
      // Marketing efficiency cohort averages (estimated)
      gMER: 2.2,
      MER: 2.0,
      pMER: 0.88,
      
      monthsToMilestone: 30,
    };

    // Monthly trend data (Jan-Jun 2025, in $K)
    const MONTHLY = {
      months: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
      netRevenue: [1171.7, 1104.8, 997.5, 1032.5, 878.7, 1483.5],
      grossProfit: [837.0, 713.7, 668.0, 674.7, 552.6, 1008.8],
      ga: [55.1, 77.4, 55.4, 47.4, 51.7, 55.0],
      sm: [318.5, 450.1, 438.5, 418.4, 425.3, 436.5],
      operations: [159.0, 124.9, 170.3, 145.3, 134.6, 122.2],
      payroll: [45.0, 17.6, 17.7, 35.3, 41.9, 41.8],
      advertising: [309.2, 403.3, 432.3, 405.8, 389.4, 412.7],
      totalOpex: [532.6, 652.4, 664.2, 611.1, 611.6, 613.7],
      ebitda: [304.4, 61.3, 3.9, 63.6, -59.0, 395.1],
      netIncome: [304.3, 55.5, -2.3, 22.6, -59.4, 394.4],
    };

    // Calculate MER metrics monthly
    MONTHLY.gMER = MONTHLY.netRevenue.map((rev, i) => rev / MONTHLY.advertising[i]);
    MONTHLY.MER = MONTHLY.netRevenue.map((rev, i) => rev / MONTHLY.sm[i]);
    MONTHLY.pMER = MONTHLY.grossProfit.map((gp, i) => gp / MONTHLY.sm[i]);
    MONTHLY.ebitdaMargin = MONTHLY.ebitda.map((eb, i) => (eb / MONTHLY.netRevenue[i]) * 100);
    MONTHLY.grossMargin = MONTHLY.grossProfit.map((gp, i) => (gp / MONTHLY.netRevenue[i]) * 100);

    // OpEx as % of revenue monthly
    MONTHLY.gaPct = MONTHLY.ga.map((g, i) => (g / MONTHLY.netRevenue[i]) * 100);
    MONTHLY.smPct = MONTHLY.sm.map((s, i) => (s / MONTHLY.netRevenue[i]) * 100);
    MONTHLY.opsPct = MONTHLY.operations.map((o, i) => (o / MONTHLY.netRevenue[i]) * 100);
    MONTHLY.payrollPct = MONTHLY.payroll.map((p, i) => (p / MONTHLY.netRevenue[i]) * 100);
    MONTHLY.cacPct = MONTHLY.advertising.map((a, i) => (a / MONTHLY.netRevenue[i]) * 100);
    MONTHLY.otherPct = MONTHLY.months.map((_, i) => {
      const other = MONTHLY.totalOpex[i] - MONTHLY.payroll[i] - MONTHLY.advertising[i];
      return (other / MONTHLY.netRevenue[i]) * 100;
    });

    // ============================================================================
    // REUSABLE COMPONENTS
    // ============================================================================

    // Metric Card - OUTLINED STYLE (Item 7)
    const MetricCard = ({ label, value, subtext, performance }) => {
      const colors = {
        good: GREEN,
        bad: RED,
        neutral: GOLD
      };
      const borderColor = performance ? colors[performance] : TEAL;
      
      return (
        <div style={{
          backgroundColor: 'white',
          border: `2px solid ${borderColor}`,
          padding: '14px 12px',
          borderRadius: '8px',
          textAlign: 'center',
          flex: 1,
          minWidth: '90px'
        }}>
          <div style={{ fontSize: '9px', color: '#666', marginBottom: '6px', textTransform: 'uppercase', letterSpacing: '0.5px' }}>{label}</div>
          <div style={{ fontSize: '20px', fontWeight: 'bold', color: borderColor }}>{value}</div>
          {subtext && <div style={{ fontSize: '9px', color: '#888', marginTop: '4px' }}>{subtext}</div>}
        </div>
      );
    };

    // Variance Bar with badge support (Item 3)
    const VarianceBar = ({ label, companyPct, cohortPct, companyLabel = "Flaus", cohortLabel = "Cohort", lowerIsBetter = false, badge = null }) => {
      const isPositive = lowerIsBetter ? companyPct < cohortPct : companyPct > cohortPct;
      const delta = Math.abs(companyPct - cohortPct).toFixed(1);
      const maxPct = Math.max(Math.abs(companyPct), Math.abs(cohortPct), 1);
      const scale = 75 / maxPct;
      
      return (
        <div style={{ marginBottom: '14px' }}>
          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '4px' }}>
            <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
              <span style={{ fontSize: '12px', fontWeight: '600', color: '#333' }}>{label}</span>
              {badge && (
                <span style={{ 
                  fontSize: '9px', 
                  padding: '2px 6px', 
                  borderRadius: '10px',
                  backgroundColor: badge === 'above max' ? LIGHT_GREEN : LIGHT_AMBER,
                  color: badge === 'above max' ? GREEN : AMBER,
                  fontWeight: '600'
                }}>
                  {badge}
                </span>
              )}
            </div>
            <span style={{ fontSize: '11px', color: isPositive ? GREEN : RED, fontWeight: '600' }}>
              {isPositive ? '▲' : '▼'} {delta} pts
            </span>
          </div>
          <div style={{ display: 'flex', gap: '8px', alignItems: 'center' }}>
            <div style={{ flex: 1 }}>
              <div style={{ display: 'flex', alignItems: 'center', marginBottom: '3px' }}>
                <div style={{ width: '50px', fontSize: '10px', color: '#666' }}>{companyLabel}</div>
                <div style={{ flex: 1, backgroundColor: '#eee', height: '20px', borderRadius: '3px', overflow: 'hidden' }}>
                  <div style={{ 
                    width: `${Math.min(Math.abs(companyPct) * scale, 100)}%`, 
                    backgroundColor: TEAL, 
                    height: '100%',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'flex-end',
                    paddingRight: '8px',
                    minWidth: '45px'
                  }}>
                    <span style={{ color: 'white', fontSize: '11px', fontWeight: '600' }}>{companyPct.toFixed(1)}%</span>
                  </div>
                </div>
              </div>
              <div style={{ display: 'flex', alignItems: 'center' }}>
                <div style={{ width: '50px', fontSize: '10px', color: '#666' }}>{cohortLabel}</div>
                <div style={{ flex: 1, backgroundColor: '#eee', height: '20px', borderRadius: '3px', overflow: 'hidden' }}>
                  <div style={{ 
                    width: `${Math.min(Math.abs(cohortPct) * scale, 100)}%`, 
                    backgroundColor: GOLD, 
                    height: '100%',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'flex-end',
                    paddingRight: '8px',
                    minWidth: '45px'
                  }}>
                    <span style={{ color: 'white', fontSize: '11px', fontWeight: '600' }}>{cohortPct.toFixed(1)}%</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      );
    };

    // Capital Variance Bar (for non-percentage metrics)
    const CapitalVarianceBar = ({ label, companyVal, cohortVal, unit = "", lowerIsBetter = false }) => {
      // Special case: Growth Efficiency - negative is GOOD (cash generative)
      let isPositive;
      if (label.includes('Growth Efficiency') && companyVal < 0) {
        isPositive = true; // Negative growth efficiency = cash generative = GOOD
      } else {
        isPositive = lowerIsBetter ? companyVal < cohortVal : companyVal > cohortVal;
      }
      const maxVal = Math.max(Math.abs(companyVal), Math.abs(cohortVal), 0.1);
      const scale = 75 / maxVal;
      
      // Special case for growth efficiency
      const deltaText = label.includes('Growth Efficiency') && companyVal < 0 
        ? 'Cash Generative' 
        : `${Math.abs(companyVal - cohortVal).toFixed(1)}${unit}`;
      
      return (
        <div style={{ marginBottom: '14px' }}>
          <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '4px' }}>
            <span style={{ fontSize: '12px', fontWeight: '600', color: '#333' }}>{label}</span>
            <span style={{ fontSize: '11px', color: isPositive ? GREEN : RED, fontWeight: '600' }}>
              {isPositive ? '▲' : '▼'} {deltaText}
            </span>
          </div>
          <div style={{ display: 'flex', gap: '8px', alignItems: 'center' }}>
            <div style={{ flex: 1 }}>
              <div style={{ display: 'flex', alignItems: 'center', marginBottom: '3px' }}>
                <div style={{ width: '50px', fontSize: '10px', color: '#666' }}>Flaus</div>
                <div style={{ flex: 1, backgroundColor: '#eee', height: '20px', borderRadius: '3px', overflow: 'hidden' }}>
                  <div style={{ 
                    width: `${Math.min(Math.abs(companyVal) * scale, 100)}%`, 
                    backgroundColor: TEAL, 
                    height: '100%',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'flex-end',
                    paddingRight: '8px',
                    minWidth: '50px'
                  }}>
                    <span style={{ color: 'white', fontSize: '11px', fontWeight: '600' }}>{companyVal.toFixed(1)}{unit}</span>
                  </div>
                </div>
              </div>
              <div style={{ display: 'flex', alignItems: 'center' }}>
                <div style={{ width: '50px', fontSize: '10px', color: '#666' }}>Cohort</div>
                <div style={{ flex: 1, backgroundColor: '#eee', height: '20px', borderRadius: '3px', overflow: 'hidden' }}>
                  <div style={{ 
                    width: `${Math.min(Math.abs(cohortVal) * scale, 100)}%`, 
                    backgroundColor: GOLD, 
                    height: '100%',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'flex-end',
                    paddingRight: '8px',
                    minWidth: '50px'
                  }}>
                    <span style={{ color: 'white', fontSize: '11px', fontWeight: '600' }}>{cohortVal.toFixed(1)}{unit}</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      );
    };

    // MER Variance Bar (for x metrics)
    const MERVarianceBar = ({ label, companyVal, cohortVal, formula }) => {
      const isPositive = companyVal > cohortVal;
      const maxVal = Math.max(companyVal, cohortVal, 0.1);
      const scale = 75 / maxVal;
      
      return (
        <div style={{ marginBottom: '14px' }}>
          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '4px' }}>
            <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
              <span style={{ fontSize: '12px', fontWeight: '600', color: '#333' }}>{label}</span>
              <span style={{ fontSize: '9px', color: '#888' }}>({formula})</span>
            </div>
            <span style={{ fontSize: '11px', color: isPositive ? GREEN : RED, fontWeight: '600' }}>
              {isPositive ? '▲' : '▼'} {Math.abs(companyVal - cohortVal).toFixed(2)}x
            </span>
          </div>
          <div style={{ display: 'flex', gap: '8px', alignItems: 'center' }}>
            <div style={{ flex: 1 }}>
              <div style={{ display: 'flex', alignItems: 'center', marginBottom: '3px' }}>
                <div style={{ width: '50px', fontSize: '10px', color: '#666' }}>Flaus</div>
                <div style={{ flex: 1, backgroundColor: '#eee', height: '20px', borderRadius: '3px', overflow: 'hidden' }}>
                  <div style={{ 
                    width: `${Math.min(companyVal * scale, 100)}%`, 
                    backgroundColor: TEAL, 
                    height: '100%',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'flex-end',
                    paddingRight: '8px',
                    minWidth: '45px'
                  }}>
                    <span style={{ color: 'white', fontSize: '11px', fontWeight: '600' }}>{companyVal.toFixed(2)}x</span>
                  </div>
                </div>
              </div>
              <div style={{ display: 'flex', alignItems: 'center' }}>
                <div style={{ width: '50px', fontSize: '10px', color: '#666' }}>Cohort</div>
                <div style={{ flex: 1, backgroundColor: '#eee', height: '20px', borderRadius: '3px', overflow: 'hidden' }}>
                  <div style={{ 
                    width: `${Math.min(cohortVal * scale, 100)}%`, 
                    backgroundColor: GOLD, 
                    height: '100%',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'flex-end',
                    paddingRight: '8px',
                    minWidth: '45px'
                  }}>
                    <span style={{ color: 'white', fontSize: '11px', fontWeight: '600' }}>{cohortVal.toFixed(2)}x</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      );
    };

    const Card = ({ children, style = {} }) => (
      <div style={{ 
        backgroundColor: 'white', 
        borderRadius: '8px', 
        padding: '18px 20px',
        boxShadow: '0 1px 3px rgba(0,0,0,0.08)',
        ...style
      }}>
        {children}
      </div>
    );

    const SectionHeader = ({ children }) => (
      <div style={{ 
        fontWeight: '600', 
        color: TEAL,
        fontSize: '14px',
        marginBottom: '16px',
        paddingBottom: '8px',
        borderBottom: `2px solid ${GOLD}`
      }}>
        {children}
      </div>
    );

    const InsightBox = ({ lead, children }) => (
      <div style={{ 
        marginTop: '12px', 
        padding: '10px 12px', 
        backgroundColor: LIGHT_TEAL, 
        borderRadius: '6px', 
        fontSize: '11px', 
        color: '#555',
        lineHeight: '1.5'
      }}>
        <strong style={{ color: TEAL }}>{lead}:</strong> {children}
      </div>
    );

    const CalloutBox = ({ type, title, children }) => {
      const styles = {
        strength: { bg: LIGHT_GREEN, border: GREEN, icon: '✓' },
        warning: { bg: LIGHT_AMBER, border: AMBER, icon: '⚠' },
        strategic: { bg: LIGHT_TEAL, border: TEAL, icon: '→' },
      };
      const s = styles[type] || styles.strategic;
      
      return (
        <div style={{ 
          backgroundColor: s.bg, 
          border: `2px solid ${s.border}`,
          borderRadius: '8px',
          padding: '14px 16px',
          marginBottom: '16px'
        }}>
          <div style={{ 
            fontSize: '13px', 
            fontWeight: '600', 
            color: s.border, 
            marginBottom: '10px',
            display: 'flex',
            alignItems: 'center',
            gap: '8px'
          }}>
            <span>{s.icon}</span> {title}
          </div>
          <div style={{ fontSize: '12px', color: '#444', lineHeight: '1.6' }}>
            {children}
          </div>
        </div>
      );
    };

    // ============================================================================
    // SANKEY CHART - Restored from v6 with bezier flows + % labels
    // ============================================================================
    const SankeyChart = () => {
      const width = 540;
      const height = 290;
      
      // Values in $000s
      const grossRev = 14776;
      const discounts = 1197;
      const netRev = 13579;
      const cogs = 4635;
      const grossProfit = 8944;
      const sm = 5120;
      const ops = 1404;
      const ga = 617;
      const ebitda = 1803;
      const other = 373;
      const netIncome = 1430;
      
      const scale = 0.016;
      
      const col1 = 25;
      const col2 = 130;
      const col3 = 235;
      const col4 = 355;
      const col5 = 455;
      
      const nodeW = 12;
      const topY = 28;
      
      const hGrossRev = grossRev * scale;
      const hDiscounts = discounts * scale;
      const hNetRev = netRev * scale;
      const hCogs = cogs * scale;
      const hGrossProfit = grossProfit * scale;
      const hSm = sm * scale;
      const hOps = ops * scale;
      const hGa = ga * scale;
      const hEbitda = ebitda * scale;
      const hOther = other * scale;
      const hNetIncome = netIncome * scale;

      // Bezier curve for flow
      const flowPath = (x1, y1, h1, x2, y2, h2) => {
        const mx = (x1 + x2) / 2;
        return `M${x1},${y1} C${mx},${y1} ${mx},${y2} ${x2},${y2} L${x2},${y2+h2} C${mx},${y2+h2} ${mx},${y1+h1} ${x1},${y1+h1} Z`;
      };

      return (
        <svg viewBox={`0 0 ${width} ${height}`} style={{ width: '100%', height: 'auto', overflow: 'hidden', display: 'block' }}>
          
          {/* === FLOWS === */}
          <path d={flowPath(col1+nodeW, topY, hNetRev, col2, topY, hNetRev)} fill={TEAL} opacity="0.25" />
          <path d={flowPath(col1+nodeW, topY + hNetRev, hDiscounts, col2-15, topY + hNetRev + 8, hDiscounts)} fill="#E57373" opacity="0.4" />
          <path d={flowPath(col2+nodeW, topY, hGrossProfit, col3, topY, hGrossProfit)} fill={TEAL} opacity="0.25" />
          <path d={flowPath(col2+nodeW, topY + hGrossProfit, hCogs, col3-15, topY + hGrossProfit + 8, hCogs)} fill="#E57373" opacity="0.4" />
          <path d={flowPath(col3+nodeW, topY, hEbitda, col4, topY, hEbitda)} fill="#4CAF50" opacity="0.3" />
          <path d={flowPath(col3+nodeW, topY + hEbitda, hSm, col4-15, topY + hEbitda + 6, hSm)} fill="#E57373" opacity="0.35" />
          <path d={flowPath(col3+nodeW, topY + hEbitda + hSm, hOps, col4-15, topY + hEbitda + hSm + 8, hOps)} fill="#E57373" opacity="0.35" />
          <path d={flowPath(col3+nodeW, topY + hEbitda + hSm + hOps, hGa, col4-15, topY + hEbitda + hSm + hOps + 10, hGa)} fill="#E57373" opacity="0.35" />
          <path d={flowPath(col4+nodeW, topY, hNetIncome, col5, topY, hNetIncome)} fill="#4CAF50" opacity="0.3" />
          <path d={flowPath(col4+nodeW, topY + hNetIncome, hOther, col5-12, topY + hNetIncome + 6, hOther)} fill="#E57373" opacity="0.35" />
          
          {/* === NODES === */}
          
          {/* Gross Revenue */}
          <rect x={col1} y={topY} width={nodeW} height={hGrossRev} fill={TEAL} rx="2" />
          <text x={col1} y={topY-14} fontSize="9" fill={TEAL} fontWeight="600">Gross Revenue</text>
          <text x={col1} y={topY-3} fontSize="10" fill={TEAL} fontWeight="700">$14.8M</text>
          <text x={col1+nodeW+4} y={topY+12} fontSize="8" fill="#666">109%</text>
          
          {/* Discounts sink */}
          <rect x={col2-15} y={topY + hNetRev + 8} width={8} height={hDiscounts} fill="#E57373" rx="2" />
          <text x={col2-4} y={topY + hNetRev + 18} fontSize="7" fill="#C62828">Disc ($1.2M)</text>
          
          {/* Net Revenue */}
          <rect x={col2} y={topY} width={nodeW} height={hNetRev} fill={TEAL} rx="2" />
          <text x={col2} y={topY-14} fontSize="9" fill={TEAL} fontWeight="600">Net Revenue</text>
          <text x={col2} y={topY-3} fontSize="10" fill={TEAL} fontWeight="700">$13.6M</text>
          <text x={col2+nodeW+4} y={topY+12} fontSize="8" fill="#666">100%</text>
          
          {/* COGS sink */}
          <rect x={col3-15} y={topY + hGrossProfit + 8} width={8} height={hCogs} fill="#E57373" rx="2" />
          <text x={col3-4} y={topY + hGrossProfit + 18} fontSize="7" fill="#C62828">COGS ($4.6M)</text>
          
          {/* Gross Profit */}
          <rect x={col3} y={topY} width={nodeW} height={hGrossProfit} fill="#4CAF50" rx="2" />
          <text x={col3} y={topY-14} fontSize="9" fill="#2E7D32" fontWeight="600">Gross Profit</text>
          <text x={col3} y={topY-3} fontSize="10" fill="#2E7D32" fontWeight="700">$8.9M</text>
          <text x={col3+nodeW+4} y={topY+12} fontSize="8" fill="#666">66%</text>
          
          {/* OpEx sinks - stacked */}
          <rect x={col4-15} y={topY + hEbitda + 6} width={8} height={hSm} fill="#E57373" rx="2" />
          <text x={col4-4} y={topY + hEbitda + 20} fontSize="7" fill="#C62828" fontWeight="600">S&M ($5.1M)</text>
          
          <rect x={col4-15} y={topY + hEbitda + hSm + 8} width={8} height={hOps} fill="#E57373" rx="2" />
          <text x={col4-4} y={topY + hEbitda + hSm + 18} fontSize="7" fill="#C62828">Ops ($1.4M)</text>
          
          <rect x={col4-15} y={topY + hEbitda + hSm + hOps + 10} width={8} height={hGa} fill="#E57373" rx="2" />
          <text x={col4-4} y={topY + hEbitda + hSm + hOps + 18} fontSize="7" fill="#C62828">G&A ($0.6M)</text>
          
          {/* EBITDA */}
          <rect x={col4} y={topY} width={nodeW} height={hEbitda} fill="#4CAF50" rx="2" />
          <text x={col4} y={topY-14} fontSize="9" fill="#2E7D32" fontWeight="600">EBITDA</text>
          <text x={col4} y={topY-3} fontSize="10" fill="#2E7D32" fontWeight="700">$1.8M</text>
          <text x={col4+nodeW+4} y={topY+12} fontSize="8" fill="#666">13%</text>
          
          {/* Other sink */}
          <rect x={col5-12} y={topY + hNetIncome + 6} width={6} height={hOther} fill="#E57373" rx="1" />
          <text x={col5-4} y={topY + hNetIncome + 14} fontSize="7" fill="#C62828">Other ($0.4M)</text>
          
          {/* Net Income */}
          <rect x={col5} y={topY} width={nodeW} height={hNetIncome} fill="#4CAF50" rx="2" />
          <text x={col5} y={topY-14} fontSize="9" fill="#2E7D32" fontWeight="600">Net Income</text>
          <text x={col5} y={topY-3} fontSize="10" fill="#2E7D32" fontWeight="700">$1.4M</text>
          <text x={col5+nodeW+4} y={topY+12} fontSize="8" fill="#666">11%</text>
        </svg>
      );
    };

    // ============================================================================
    // WATERFALL CHART - Restored from v6
    // ============================================================================
    const WaterfallChart = () => {
      const maxVal = 16000;
      const chartHeight = 180;
      const barWidth = 48;
      const gap = 8;
      
      const data = [
        { label: 'Gross Rev', value: 14776, bottom: 0, type: 'revenue', showValue: true },
        { label: 'Discounts', value: 1198, bottom: 14776 - 1198, type: 'negative', showValue: false },
        { label: 'Net Rev', value: 13579, bottom: 0, type: 'revenue', showValue: true },
        { label: 'COGS', value: 4634, bottom: 8944, type: 'negative', showValue: false },
        { label: 'Gross Profit', value: 8944, bottom: 0, type: 'profit', showValue: true },
        { label: 'G&A', value: 617, bottom: 8944 - 617, type: 'negative', showValue: false },
        { label: 'S&M', value: 5120, bottom: 8944 - 617 - 5120, type: 'negative', showValue: false },
        { label: 'Ops', value: 1404, bottom: 1803, type: 'negative', showValue: false },
        { label: 'EBITDA', value: 1803, bottom: 0, type: 'profit', showValue: true },
      ];

      const getY = (val) => chartHeight - (val / maxVal) * chartHeight;
      const getHeight = (val) => (val / maxVal) * chartHeight;
      const chartWidth = data.length * (barWidth + gap) + 50;
      
      const getColor = (type) => {
        if (type === 'negative') return '#E57373';
        if (type === 'profit') return '#4CAF50';
        return TEAL;
      };

      return (
        <div style={{ marginTop: '4px' }}>
          <svg width="100%" viewBox={`0 0 ${chartWidth} ${chartHeight + 45}`} style={{ maxWidth: chartWidth, overflow: 'visible' }}>
            <text x="5" y="12" fontSize="9" fill="#999">$15M</text>
            <text x="5" y={chartHeight * 0.5 + 4} fontSize="9" fill="#999">$7.5M</text>
            <text x="5" y={chartHeight + 4} fontSize="9" fill="#999">$0</text>
            
            <line x1="40" y1={chartHeight} x2={chartWidth - 10} y2={chartHeight} stroke="#ddd" />
            <line x1="40" y1={chartHeight * 0.5} x2={chartWidth - 10} y2={chartHeight * 0.5} stroke="#eee" strokeDasharray="4" />
            
            {data.map((item, i) => {
              const x = 45 + i * (barWidth + gap);
              const barHeight = getHeight(item.value);
              const y = getY(item.bottom + item.value);
              const color = getColor(item.type);
              
              return (
                <g key={i}>
                  <rect x={x} y={y} width={barWidth} height={barHeight} fill={color} rx="3" />
                  
                  {item.showValue && (
                    <text x={x + barWidth/2} y={y - 6} fontSize="10" fontWeight="600" fill={color} textAnchor="middle">
                      ${(item.value/1000).toFixed(1)}M
                    </text>
                  )}
                  
                  <text 
                    x={x + barWidth/2} 
                    y={chartHeight + 14} 
                    fontSize="9" 
                    fill={item.type !== 'negative' ? getColor(item.type) : '#666'}
                    fontWeight={item.type !== 'negative' ? '600' : '400'}
                    textAnchor="middle"
                  >
                    {item.label}
                  </text>
                </g>
              );
            })}
          </svg>
          
          {/* Legend */}
          <div style={{ marginTop: '8px', display: 'flex', gap: '12px', fontSize: '9px' }}>
            <div style={{ display: 'flex', alignItems: 'center', gap: '3px' }}>
              <div style={{ width: 10, height: 10, backgroundColor: TEAL, borderRadius: 2 }}></div>
              <span>Revenue</span>
            </div>
            <div style={{ display: 'flex', alignItems: 'center', gap: '3px' }}>
              <div style={{ width: 10, height: 10, backgroundColor: '#4CAF50', borderRadius: 2 }}></div>
              <span>Profit</span>
            </div>
            <div style={{ display: 'flex', alignItems: 'center', gap: '3px' }}>
              <div style={{ width: 10, height: 10, backgroundColor: '#E57373', borderRadius: 2 }}></div>
              <span>Expense</span>
            </div>
          </div>
        </div>
      );
    };

    // ============================================================================
    // OPEX TREEMAP - Restored from v6 with nested subcategories
    // Percentages shown as % of Net Revenue ($13.6M)
    // ============================================================================
    const OpExTreemap = () => {
      const netRevenue = 13579; // $000s
      const categories = [
        { 
          name: 'Sales & Marketing', 
          color: '#E57373',
          total: 5120,
          pctRev: 37.7,  // 5120/13579
          items: [
            { label: 'Advertising', value: 4830, pctRev: 35.6 },
            { label: 'Conferences', value: 130, pctRev: 1.0 },
            { label: 'PR & Other', value: 160, pctRev: 1.2 },
          ]
        },
        { 
          name: 'Operations', 
          color: '#81C784',
          total: 1609,
          pctRev: 11.8,  // 1609/13579
          items: [
            { label: 'People & HR', value: 518, pctRev: 3.8 },
            { label: 'Prof. Services', value: 432, pctRev: 3.2 },
            { label: 'Technology', value: 390, pctRev: 2.9 },
            { label: 'Amortization', value: 205, pctRev: 1.5 },
            { label: 'Other', value: 64, pctRev: 0.5 },
          ]
        },
        { 
          name: 'G&A', 
          color: '#64B5F6',
          total: 617,
          pctRev: 4.5,  // 617/13579
          items: [
            { label: 'Cust. Success', value: 230, pctRev: 1.7 },
            { label: 'Contractors', value: 155, pctRev: 1.1 },
            { label: 'Insurance', value: 145, pctRev: 1.1 },
            { label: 'Other', value: 87, pctRev: 0.6 },
          ]
        },
      ];
      
      const grandTotal = 7346;
      const height = 140;

      return (
        <div>
          <div style={{ display: 'flex', height, gap: '3px' }}>
            {categories.map((cat, catIdx) => {
              const catWidthPct = (cat.total / grandTotal) * 100;
              
              return (
                <div 
                  key={catIdx} 
                  style={{ 
                    width: `${catWidthPct}%`, 
                    display: 'flex', 
                    flexDirection: 'column',
                    gap: '2px'
                  }}
                >
                  {/* Category header - now shows % of revenue */}
                  <div style={{ 
                    fontSize: '11px', 
                    fontWeight: '600', 
                    color: '#333',
                    marginBottom: '2px'
                  }}>
                    {cat.name} <span style={{ color: '#666', fontWeight: '500' }}>${(cat.total/1000).toFixed(1)}M ({cat.pctRev}% of rev)</span>
                  </div>
                  
                  {/* Items container - different layouts based on category */}
                  {catIdx === 0 ? (
                    // S&M: One big block (Advertising) with small blocks below
                    <div style={{ flex: 1, display: 'flex', flexDirection: 'column', gap: '2px' }}>
                      <div 
                        style={{ 
                          flex: 1, 
                          backgroundColor: cat.color, 
                          borderRadius: '4px',
                          display: 'flex',
                          alignItems: 'center',
                          justifyContent: 'center',
                          flexDirection: 'column',
                          minHeight: '80px'
                        }}
                      >
                        <span style={{ color: 'white', fontSize: '12px', fontWeight: '600' }}>Advertising</span>
                        <span style={{ color: 'white', fontSize: '11px', opacity: 0.9 }}>${(4830/1000).toFixed(1)}M (35.6% of rev)</span>
                      </div>
                      <div style={{ display: 'flex', gap: '2px', height: '28px' }}>
                        <div style={{ flex: 1, backgroundColor: cat.color, opacity: 0.7, borderRadius: '3px', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                          <span style={{ color: 'white', fontSize: '9px' }}>Conf. $130K</span>
                        </div>
                        <div style={{ flex: 1, backgroundColor: cat.color, opacity: 0.5, borderRadius: '3px', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                          <span style={{ color: 'white', fontSize: '9px' }}>PR $160K</span>
                        </div>
                      </div>
                    </div>
                  ) : catIdx === 1 ? (
                    // Operations: 2x3 grid layout
                    <div style={{ flex: 1, display: 'flex', flexDirection: 'column', gap: '2px' }}>
                      <div style={{ display: 'flex', gap: '2px', flex: 1 }}>
                        <div style={{ flex: 1, backgroundColor: cat.color, borderRadius: '4px', display: 'flex', alignItems: 'center', justifyContent: 'center', flexDirection: 'column', padding: '4px' }}>
                          <span style={{ color: 'white', fontSize: '10px', fontWeight: '600' }}>People & HR</span>
                          <span style={{ color: 'white', fontSize: '9px', opacity: 0.9 }}>$518K (3.8%)</span>
                        </div>
                        <div style={{ flex: 0.85, backgroundColor: cat.color, opacity: 0.85, borderRadius: '4px', display: 'flex', alignItems: 'center', justifyContent: 'center', flexDirection: 'column', padding: '4px' }}>
                          <span style={{ color: 'white', fontSize: '10px', fontWeight: '600' }}>Prof. Svc</span>
                          <span style={{ color: 'white', fontSize: '9px', opacity: 0.9 }}>$432K (3.2%)</span>
                        </div>
                      </div>
                      <div style={{ display: 'flex', gap: '2px', flex: 0.7 }}>
                        <div style={{ flex: 1, backgroundColor: cat.color, opacity: 0.7, borderRadius: '3px', display: 'flex', alignItems: 'center', justifyContent: 'center', flexDirection: 'column' }}>
                          <span style={{ color: 'white', fontSize: '9px', fontWeight: '500' }}>Tech $390K (2.9%)</span>
                        </div>
                        <div style={{ flex: 0.6, backgroundColor: cat.color, opacity: 0.55, borderRadius: '3px', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                          <span style={{ color: 'white', fontSize: '8px' }}>Amort $205K</span>
                        </div>
                        <div style={{ flex: 0.3, backgroundColor: cat.color, opacity: 0.4, borderRadius: '3px', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                          <span style={{ color: 'white', fontSize: '8px' }}>$64K</span>
                        </div>
                      </div>
                    </div>
                  ) : (
                    // G&A: 2x2 grid
                    <div style={{ flex: 1, display: 'flex', flexDirection: 'column', gap: '2px' }}>
                      <div style={{ display: 'flex', gap: '2px', flex: 1 }}>
                        <div style={{ flex: 1, backgroundColor: cat.color, borderRadius: '4px', display: 'flex', alignItems: 'center', justifyContent: 'center', flexDirection: 'column' }}>
                          <span style={{ color: 'white', fontSize: '9px', fontWeight: '600' }}>Cust. Success</span>
                          <span style={{ color: 'white', fontSize: '8px', opacity: 0.9 }}>$230K</span>
                        </div>
                        <div style={{ flex: 0.7, backgroundColor: cat.color, opacity: 0.8, borderRadius: '4px', display: 'flex', alignItems: 'center', justifyContent: 'center', flexDirection: 'column' }}>
                          <span style={{ color: 'white', fontSize: '9px', fontWeight: '600' }}>Contractors</span>
                          <span style={{ color: 'white', fontSize: '8px', opacity: 0.9 }}>$155K</span>
                        </div>
                      </div>
                      <div style={{ display: 'flex', gap: '2px', flex: 0.7 }}>
                        <div style={{ flex: 1, backgroundColor: cat.color, opacity: 0.65, borderRadius: '3px', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                          <span style={{ color: 'white', fontSize: '8px' }}>Insurance $145K</span>
                        </div>
                        <div style={{ flex: 0.6, backgroundColor: cat.color, opacity: 0.5, borderRadius: '3px', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                          <span style={{ color: 'white', fontSize: '8px' }}>Other $87K</span>
                        </div>
                      </div>
                    </div>
                  )}
                </div>
              );
            })}
          </div>
          
          {/* Legend with $ and % of revenue */}
          <div style={{ display: 'flex', gap: '20px', marginTop: '12px', justifyContent: 'center' }}>
            {categories.map((cat, i) => (
              <div key={i} style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
                <div style={{ width: 14, height: 14, backgroundColor: cat.color, borderRadius: 3 }}></div>
                <span style={{ fontSize: '11px', color: '#555' }}>
                  {cat.name}: <strong>${(cat.total/1000).toFixed(1)}M</strong> ({cat.pctRev}% of rev)
                </span>
              </div>
            ))}
          </div>
        </div>
      );
    };

    // OpEx Treemap by Priority (Payroll, CAC, Other)
    const OpExTreemapByPriority = () => {
      const categories = [
        { 
          name: 'Customer Acquisition', 
          color: '#7C3AED', // Purple
          total: 4831,
          pctRev: 35.6,
          items: [
            { label: 'Paid Media', value: 4630, pctRev: 34.1 },
            { label: 'Other CAC', value: 201, pctRev: 1.5 },
          ]
        },
        { 
          name: 'Other OpEx', 
          color: '#F59E0B', // Amber
          total: 1996,
          pctRev: 14.7,
          items: [
            { label: 'Fulfillment', value: 890, pctRev: 6.6 },
            { label: 'Prof. Svc', value: 432, pctRev: 3.2 },
            { label: 'Technology', value: 390, pctRev: 2.9 },
            { label: 'Insurance', value: 145, pctRev: 1.1 },
            { label: 'Other', value: 139, pctRev: 1.0 },
          ]
        },
        { 
          name: 'Payroll', 
          color: '#0EA5E9', // Sky blue
          total: 518,
          pctRev: 3.8,
          items: [
            { label: 'Salaries', value: 420, pctRev: 3.1 },
            { label: 'Benefits', value: 98, pctRev: 0.7 },
          ]
        },
      ];
      
      const grandTotal = 7345;
      const height = 120;

      return (
        <div>
          <div style={{ display: 'flex', height, gap: '3px' }}>
            {categories.map((cat, catIdx) => {
              const catWidthPct = (cat.total / grandTotal) * 100;
              
              return (
                <div 
                  key={catIdx} 
                  style={{ 
                    width: `${catWidthPct}%`, 
                    display: 'flex', 
                    flexDirection: 'column',
                    gap: '2px'
                  }}
                >
                  <div style={{ 
                    fontSize: '11px', 
                    fontWeight: '600', 
                    color: '#333',
                    marginBottom: '2px'
                  }}>
                    {cat.name} <span style={{ color: '#666', fontWeight: '500' }}>${(cat.total/1000).toFixed(1)}M ({cat.pctRev}% of rev)</span>
                  </div>
                  
                  {catIdx === 0 ? (
                    // CAC: One big block with small below
                    <div style={{ flex: 1, display: 'flex', flexDirection: 'column', gap: '2px' }}>
                      <div style={{ 
                        flex: 1, 
                        backgroundColor: cat.color, 
                        borderRadius: '4px',
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'center',
                        flexDirection: 'column',
                        minHeight: '70px'
                      }}>
                        <span style={{ color: 'white', fontSize: '12px', fontWeight: '600' }}>Paid Media</span>
                        <span style={{ color: 'white', fontSize: '11px', opacity: 0.9 }}>$4.6M (34.1% of rev)</span>
                      </div>
                      <div style={{ height: '24px', backgroundColor: cat.color, opacity: 0.6, borderRadius: '3px', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                        <span style={{ color: 'white', fontSize: '9px' }}>Other CAC $201K</span>
                      </div>
                    </div>
                  ) : catIdx === 1 ? (
                    // Other OpEx: Grid layout
                    <div style={{ flex: 1, display: 'flex', flexDirection: 'column', gap: '2px' }}>
                      <div style={{ display: 'flex', gap: '2px', flex: 1 }}>
                        <div style={{ flex: 1, backgroundColor: cat.color, borderRadius: '4px', display: 'flex', alignItems: 'center', justifyContent: 'center', flexDirection: 'column' }}>
                          <span style={{ color: 'white', fontSize: '10px', fontWeight: '600' }}>Fulfillment</span>
                          <span style={{ color: 'white', fontSize: '9px', opacity: 0.9 }}>$890K (6.6%)</span>
                        </div>
                        <div style={{ flex: 0.9, backgroundColor: cat.color, opacity: 0.85, borderRadius: '4px', display: 'flex', alignItems: 'center', justifyContent: 'center', flexDirection: 'column' }}>
                          <span style={{ color: 'white', fontSize: '10px', fontWeight: '600' }}>Prof. Svc</span>
                          <span style={{ color: 'white', fontSize: '9px', opacity: 0.9 }}>$432K (3.2%)</span>
                        </div>
                      </div>
                      <div style={{ display: 'flex', gap: '2px', height: '28px' }}>
                        <div style={{ flex: 1, backgroundColor: cat.color, opacity: 0.7, borderRadius: '3px', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                          <span style={{ color: 'white', fontSize: '8px' }}>Tech $390K</span>
                        </div>
                        <div style={{ flex: 0.5, backgroundColor: cat.color, opacity: 0.55, borderRadius: '3px', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                          <span style={{ color: 'white', fontSize: '8px' }}>Ins $145K</span>
                        </div>
                        <div style={{ flex: 0.4, backgroundColor: cat.color, opacity: 0.4, borderRadius: '3px', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                          <span style={{ color: 'white', fontSize: '8px' }}>$139K</span>
                        </div>
                      </div>
                    </div>
                  ) : (
                    // Payroll: Simple 2-row
                    <div style={{ flex: 1, display: 'flex', flexDirection: 'column', gap: '2px' }}>
                      <div style={{ flex: 1, backgroundColor: cat.color, borderRadius: '4px', display: 'flex', alignItems: 'center', justifyContent: 'center', flexDirection: 'column' }}>
                        <span style={{ color: 'white', fontSize: '10px', fontWeight: '600' }}>Salaries</span>
                        <span style={{ color: 'white', fontSize: '9px', opacity: 0.9 }}>$420K (3.1%)</span>
                      </div>
                      <div style={{ height: '24px', backgroundColor: cat.color, opacity: 0.7, borderRadius: '3px', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                        <span style={{ color: 'white', fontSize: '9px' }}>Benefits $98K</span>
                      </div>
                    </div>
                  )}
                </div>
              );
            })}
          </div>
          
          {/* Legend */}
          <div style={{ display: 'flex', gap: '20px', marginTop: '12px', justifyContent: 'center' }}>
            {categories.map((cat, i) => (
              <div key={i} style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
                <div style={{ width: 14, height: 14, backgroundColor: cat.color, borderRadius: 3 }}></div>
                <span style={{ fontSize: '11px', color: '#555' }}>
                  {cat.name}: <strong>${(cat.total/1000).toFixed(1)}M</strong> ({cat.pctRev}% of rev)
                </span>
              </div>
            ))}
          </div>
        </div>
      );
    };

    // ============================================================================
    // TREND CHARTS
    // ============================================================================
    
    // Single-line trend chart with aligned cohort label
    const TrendChart = ({ title, data, cohortValue, unit = '%', cohortLabel = 'Cohort' }) => {
      const actualMax = Math.max(...data, cohortValue);
      const actualMin = Math.min(...data, 0);
      const maxVal = actualMax * 1.15;
      const minVal = Math.min(actualMin, 0);
      const range = maxVal - minVal;
      
      const chartW = 260;
      const chartH = 70;
      
      const getX = (i) => (i / (data.length - 1)) * chartW;
      const getY = (val) => chartH - ((val - minVal) / range) * chartH;
      
      const points = data.map((d, i) => `${getX(i)},${getY(d)}`).join(' ');
      const cohortY = getY(cohortValue);

      return (
        <div style={{ marginBottom: '16px' }}>
          <div style={{ fontSize: '11px', fontWeight: '600', color: '#333', marginBottom: '8px' }}>{title}</div>
          <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
            <div style={{ display: 'flex', flexDirection: 'column', justifyContent: 'space-between', height: chartH, fontSize: '9px', color: '#999', minWidth: '32px', textAlign: 'right' }}>
              <span>{maxVal.toFixed(unit === 'x' ? 1 : 0)}{unit}</span>
              <span>{minVal.toFixed(unit === 'x' ? 1 : 0)}{unit}</span>
            </div>
            <div style={{ flex: 1, position: 'relative' }}>
              <svg viewBox={`0 0 ${chartW} ${chartH + 16}`} style={{ width: '100%', overflow: 'visible' }}>
                <line x1="0" y1={chartH} x2={chartW} y2={chartH} stroke="#ddd" />
                <polyline points={points} fill="none" stroke={TEAL} strokeWidth="2.5" />
                {data.map((d, i) => (
                  <g key={i}>
                    <circle cx={getX(i)} cy={getY(d)} r="3" fill={TEAL} />
                    <text x={getX(i)} y={chartH + 12} fontSize="8" fill="#666" textAnchor="middle">{MONTHLY.months[i]}</text>
                  </g>
                ))}
                <circle cx={chartW} cy={cohortY} r="5" fill={GOLD} />
              </svg>
            </div>
            <div style={{ 
              fontSize: '9px', 
              color: GOLD, 
              fontWeight: '600', 
              minWidth: '50px',
              position: 'relative',
              height: chartH
            }}>
              <span style={{ 
                position: 'absolute', 
                top: `${cohortY}px`,
                transform: 'translateY(-50%)'
              }}>
                {cohortLabel}
              </span>
            </div>
          </div>
        </div>
      );
    };

    // Multi-line trend chart with color-matched cohort dots (Item 22 fix)
    // v8.3: Lighter middle gray, legend next to title
    const MultiTrendChart = ({ title, lines, cohorts, unit = '%', showBreakeven = false }) => {
      const allValues = lines.flatMap(l => l.data).concat(cohorts.map(c => c.value));
      const maxVal = Math.max(...allValues) * 1.15;
      const minVal = showBreakeven ? 0 : Math.min(...allValues, 0);
      const range = maxVal - minVal;
      
      const chartW = 260;
      const chartH = 70;
      // Blue, light gray, dark gray - middle line now lighter for distinction
      const colors = ['#2563EB', '#9CA3AF', '#374151'];
      
      const getX = (i) => (i / 5) * chartW;
      const getY = (val) => chartH - ((val - minVal) / range) * chartH;

      return (
        <div style={{ marginBottom: '16px' }}>
          {/* Title with inline legend */}
          <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '8px' }}>
            <div style={{ fontSize: '11px', fontWeight: '600', color: '#333' }}>{title}</div>
            <div style={{ display: 'flex', gap: '12px', fontSize: '10px' }}>
              {lines.map((line, li) => (
                <div key={li} style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>
                  <div style={{ width: 12, height: 3, backgroundColor: colors[li], borderRadius: 1 }}></div>
                  <span style={{ color: colors[li], fontWeight: '500' }}>{line.label}</span>
                </div>
              ))}
            </div>
          </div>
          <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
            <div style={{ display: 'flex', flexDirection: 'column', justifyContent: 'space-between', height: chartH, fontSize: '9px', color: '#999', minWidth: '32px', textAlign: 'right' }}>
              <span>{maxVal.toFixed(unit === 'x' ? 1 : 0)}{unit}</span>
              <span>{minVal.toFixed(unit === 'x' ? 1 : 0)}{unit}</span>
            </div>
            <div style={{ flex: 1 }}>
              <svg viewBox={`0 0 ${chartW} ${chartH + 16}`} style={{ width: '100%', overflow: 'visible' }}>
                <line x1="0" y1={chartH} x2={chartW} y2={chartH} stroke="#ddd" />
                
                {showBreakeven && (
                  <line x1="0" y1={getY(1)} x2={chartW} y2={getY(1)} stroke={RED} strokeWidth="1" strokeDasharray="4" />
                )}
                
                {lines.map((line, li) => (
                  <g key={li}>
                    <polyline 
                      points={line.data.map((d, i) => `${getX(i)},${getY(d)}`).join(' ')} 
                      fill="none" 
                      stroke={colors[li]} 
                      strokeWidth="2"
                    />
                    {line.data.map((d, i) => (
                      <circle key={i} cx={getX(i)} cy={getY(d)} r="2.5" fill={colors[li]} />
                    ))}
                  </g>
                ))}
                
                {/* Cohort dots - color matched to their lines (Item 22) */}
                {cohorts.map((c, ci) => (
                  <circle key={ci} cx={chartW + 5} cy={getY(c.value)} r="4" fill={colors[ci]} />
                ))}
                
                {MONTHLY.months.map((m, i) => (
                  <text key={i} x={getX(i)} y={chartH + 12} fontSize="8" fill="#666" textAnchor="middle">{m}</text>
                ))}
              </svg>
            </div>
            {/* Cohort label aligned to dots */}
            <div style={{ minWidth: '45px', fontSize: '9px', color: '#666', fontWeight: '500' }}>
              Cohort
            </div>
          </div>
        </div>
      );
    };

    // MER Chart with formulas and pMER emphasis
    const MERChart = () => {
      const lines = [
        { label: 'MER', data: MONTHLY.MER, formula: 'Rev ÷ All Mkt' },
        { label: 'gMER', data: MONTHLY.gMER, formula: 'Rev ÷ Paid Media' },
        { label: 'pMER', data: MONTHLY.pMER, formula: 'GP ÷ All Mkt' },
      ];
      
      const allValues = lines.flatMap(l => l.data);
      const maxVal = Math.max(...allValues) * 1.15;
      const minVal = 0;
      const range = maxVal - minVal;
      
      const chartW = 260;
      const chartH = 80;
      const colors = ['#2563EB', '#6B7280', GREEN];
      
      const getX = (i) => (i / 5) * chartW;
      const getY = (val) => chartH - ((val - minVal) / range) * chartH;

      return (
        <div>
          <div style={{ fontSize: '11px', fontWeight: '600', color: '#333', marginBottom: '8px' }}>Marketing Efficiency Trend</div>
          <div style={{ display: 'flex', alignItems: 'flex-start', gap: '8px' }}>
            <div style={{ display: 'flex', flexDirection: 'column', justifyContent: 'space-between', height: chartH, fontSize: '9px', color: '#999', minWidth: '28px', textAlign: 'right' }}>
              <span>{maxVal.toFixed(1)}x</span>
              <span>0x</span>
            </div>
            <div style={{ flex: 1 }}>
              <svg viewBox={`0 0 ${chartW} ${chartH + 16}`} style={{ width: '100%', overflow: 'visible' }}>
                <line x1="0" y1={chartH} x2={chartW} y2={chartH} stroke="#ddd" />
                
                {/* Breakeven line */}
                <line x1="0" y1={getY(1)} x2={chartW} y2={getY(1)} stroke={RED} strokeWidth="1" strokeDasharray="4" />
                <text x="3" y={getY(1) - 3} fontSize="8" fill={RED}>Breakeven</text>
                
                {lines.map((line, li) => (
                  <g key={li}>
                    <polyline 
                      points={line.data.map((d, i) => `${getX(i)},${getY(d)}`).join(' ')} 
                      fill="none" 
                      stroke={colors[li]} 
                      strokeWidth={li === 2 ? 3 : 2}
                    />
                    {line.data.map((d, i) => (
                      <circle key={i} cx={getX(i)} cy={getY(d)} r={li === 2 ? 3.5 : 2.5} fill={colors[li]} />
                    ))}
                  </g>
                ))}
                
                {MONTHLY.months.map((m, i) => (
                  <text key={i} x={getX(i)} y={chartH + 12} fontSize="8" fill="#666" textAnchor="middle">{m}</text>
                ))}
              </svg>
            </div>
            {/* Legend with formulas */}
            <div style={{ minWidth: '95px', fontSize: '9px' }}>
              {lines.map((line, li) => (
                <div key={li} style={{ color: colors[li], marginBottom: '4px', display: 'flex', alignItems: 'center', gap: '4px' }}>
                  <div style={{ width: 10, height: li === 2 ? 3 : 2, backgroundColor: colors[li] }}></div>
                  <span style={{ fontWeight: li === 2 ? '600' : '400' }}>{line.label}</span>
                  <span style={{ fontSize: '8px', opacity: 0.7 }}>({line.formula})</span>
                </div>
              ))}
            </div>
          </div>
        </div>
      );
    };

    // ============================================================================
    // PAGES
    // ============================================================================

    // Page 1: Overview
    const OverviewPage = () => (
      <div className="print-page" style={{ padding: '20px 28px' }}>
        <Card>
          {/* Cohort extraordinariness callout (Item 1) */}
          <div style={{ 
            backgroundColor: LIGHT_AMBER, 
            border: `1px solid ${GOLD}`,
            borderRadius: '6px',
            padding: '12px 16px',
            marginBottom: '20px',
            fontSize: '12px',
            color: '#666'
          }}>
            <strong style={{ color: GOLD }}>Cohort Context:</strong> This analysis compares Flaus against an <strong>extraordinary cohort</strong> — top-decile performers at the $15M milestone. 
            Matching cohort averages indicates strong execution; exceeding them indicates exceptional performance.
          </div>

          <SectionHeader>Executive Summary</SectionHeader>
          
          <p style={{ fontSize: '13px', lineHeight: '1.7', color: '#444', marginBottom: '20px' }}>
            Flaus demonstrates <strong style={{ color: GREEN }}>exceptional underlying performance</strong> with multiple metrics 
            exceeding the extraordinary cohort's maximum thresholds. The company reached the $15M milestone in just 
            <strong style={{ color: TEAL }}> 18 months from first revenue</strong> — well under the cohort average of 30 months — while achieving 
            profitability that most peers at this stage cannot match.
          </p>

          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px', marginBottom: '20px' }}>
            <CalloutBox type="strength" title="Exceptional Outperformance">
              <ul style={{ margin: 0, paddingLeft: '18px' }}>
                <li>EBITDA +9.1 pts above cohort (13.3% vs 4.2%)</li>
                <li>Net Income +5.2 pts above cohort (10.5% vs 5.3%)</li>
                <li>G&A 21 pts leaner than cohort</li>
                <li>Cash generative while growing (negative growth efficiency)</li>
                <li>pMER of 1.75x (cohort ~0.88x)</li>
                <li>Reached milestone in 18 months from first revenue (vs 30 cohort avg)</li>
              </ul>
            </CalloutBox>

            <CalloutBox type="warning" title="Areas to Monitor">
              <ul style={{ margin: 0, paddingLeft: '18px' }}>
                <li>Organizational maturity at 18 months from first revenue</li>
                <li>G&A may be too lean to manage risks at this scale</li>
                <li>Supply chain depth and vendor diversification</li>
                <li>Leadership team scaled for $30M+ complexity</li>
                <li>pMER volatility month-to-month</li>
                <li>Ops costs as % of revenue (DTC structural)</li>
                <li>When/whether to deploy remaining capital</li>
              </ul>
            </CalloutBox>
          </div>

          {/* Discussion Prompts - Bulleted (Item 5) */}
          <div style={{ marginBottom: '16px' }}>
            <CalloutBox type="strategic" title="Strategic Discussion Prompts">
              <ul style={{ margin: 0, paddingLeft: '18px' }}>
                <li><strong>Growth Investment:</strong> Would Flaus benefit from a modest increase in S&M to accelerate growth while maintaining efficiency—or is the current capital-light approach optimal?</li>
                <li><strong>pMER Optimization:</strong> What's driving pMER volatility (1.37x–2.43x)? Can high-pMER months be replicated?</li>
                <li><strong>Channel Strategy:</strong> Wholesale distribution offers significant growth opportunity, but requires substantially more working capital (inventory, longer payment cycles). Current profitability may not generate sufficient cash to fund channel expansion without additional capital.</li>
                <li><strong>Capital Deployment:</strong> With $3M+ in undeployed capital and positive cash flow, what's the right deployment strategy?</li>
              </ul>
            </CalloutBox>
          </div>
          
          {/* Propeller Advisory Note - Yellow with exclamation icon and bullets (v8.3 fix) */}
          <div style={{ 
            padding: '14px 16px',
            backgroundColor: LIGHT_AMBER,
            border: `1px solid ${GOLD}`,
            borderRadius: '6px'
          }}>
            <div style={{ fontSize: '12px', fontWeight: '600', color: GOLD, marginBottom: '10px', display: 'flex', alignItems: 'center', gap: '6px' }}>
              <span>❗</span> Propeller Advisory Note
            </div>
            <p style={{ fontSize: '11px', lineHeight: '1.6', color: '#555', margin: '0 0 10px 0' }}>
              As financial advisors, we note that companies at this velocity often defer investments in compliance infrastructure, transaction readiness, and data integrity. These gaps are invisible until they become urgent—typically during a fundraise, audit, or acquisition process.
            </p>
            <p style={{ fontSize: '11px', lineHeight: '1.6', color: '#555', margin: '0 0 8px 0' }}>
              Flaus's lean G&A (4.5% vs 25.5% cohort) warrants a candid assessment of what's been deferred in:
            </p>
            <ul style={{ margin: 0, paddingLeft: '20px', fontSize: '11px', lineHeight: '1.7', color: '#555' }}>
              <li><strong>Compliance:</strong> Legal, regulatory, tax infrastructure</li>
              <li><strong>Transaction readiness:</strong> Audit prep, data room quality, financial reporting rigor</li>
              <li><strong>Data integrity:</strong> Systems, controls, reconciliation processes</li>
              <li><strong>Key person risk:</strong> With payroll at 1/4 of cohort, likely heavy founder dependency</li>
            </ul>
          </div>
        </Card>
      </div>
    );

    // Page 2: P&L Variance
    const PLVariancePage = () => (
      <div className="print-page" style={{ padding: '20px 28px' }}>
        <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '20px' }}>
          {/* Revenue vs Cohort */}
          <Card>
            <SectionHeader>Revenue vs Cohort</SectionHeader>
            <VarianceBar label="Gross Revenue" companyPct={COMPANY.grossRevenuePct} cohortPct={COHORT.grossRevenuePct} />
            <VarianceBar label="Discounts & Returns" companyPct={COMPANY.discountsPct} cohortPct={COHORT.discountsPct} lowerIsBetter />
            <VarianceBar label="Trade Deductions" companyPct={COMPANY.tradeDeductionsPct} cohortPct={COHORT.tradeDeductionsPct} lowerIsBetter />
            <InsightBox lead="Net Revenue">
              $13.6M vs $16.0M cohort — lower discounting partially offsets scale gap.
            </InsightBox>
          </Card>

          {/* Earnings vs Cohort */}
          <Card>
            <SectionHeader>Earnings vs Cohort</SectionHeader>
            <VarianceBar label="EBITDA Margin" companyPct={COMPANY.ebitdaPct} cohortPct={COHORT.ebitdaPct} badge="above max" />
            <VarianceBar label="Other Expenses" companyPct={1.2} cohortPct={COHORT.otherExpensesPct} lowerIsBetter />
            <VarianceBar label="Net Income Margin" companyPct={COMPANY.netIncomePct} cohortPct={COHORT.netIncomePct} badge="above max" />
            <InsightBox lead="+5.2 pts Net Income advantage">
              driven by exceptional EBITDA performance — both metrics above cohort maximum.
            </InsightBox>
          </Card>

          {/* OpEx by Function (Item 16) */}
          <Card>
            <SectionHeader>OpEx by Function</SectionHeader>
            <VarianceBar label="G&A" companyPct={COMPANY.gaPct} cohortPct={COHORT.gaPct} lowerIsBetter badge="above max" />
            <VarianceBar label="Sales & Marketing" companyPct={COMPANY.smPct} cohortPct={COHORT.smPct} lowerIsBetter />
            <VarianceBar label="Operations" companyPct={COMPANY.operationsPct} cohortPct={COHORT.operationsPct} lowerIsBetter />
            <InsightBox lead="DTC Model">
              Higher S&M and fulfillment offset by extremely lean G&A. See Areas to Monitor for risk framing.
            </InsightBox>
          </Card>

          {/* OpEx by Priority (Item 16) */}
          <Card>
            <SectionHeader>OpEx by Priority</SectionHeader>
            <VarianceBar label="Payroll" companyPct={COMPANY.payrollPct} cohortPct={COHORT.payrollPct} lowerIsBetter />
            <VarianceBar label="Customer Acquisition" companyPct={COMPANY.cacPct} cohortPct={COHORT.cacPct} lowerIsBetter />
            <VarianceBar label="Other OpEx" companyPct={COMPANY.otherOpexPct} cohortPct={COHORT.otherOpexPct} lowerIsBetter />
            <InsightBox lead="Staffing Risk">
              Payroll at &lt;1/4 of cohort (3.8% vs 17.2%) may indicate key-person dependency or deferred hiring at this growth rate.
            </InsightBox>
          </Card>
        </div>
      </div>
    );

    // Page 3: Analytics - Restored layout from v6
    const AnalyticsPage = () => (
      <div className="print-page" style={{ padding: '20px 28px' }}>
        <div style={{ display: 'flex', gap: '16px', marginBottom: '16px' }}>
          <Card style={{ flex: 1.1 }}>
            <SectionHeader>P&L Flow</SectionHeader>
            <SankeyChart />
          </Card>
          <Card style={{ flex: 0.9 }}>
            <SectionHeader>P&L Waterfall ($000s)</SectionHeader>
            <WaterfallChart />
          </Card>
        </div>
        
        <Card>
          <SectionHeader>Operating Expenses by Function ($7.3M Annualized)</SectionHeader>
          <OpExTreemap />
        </Card>
        
        <Card style={{ marginTop: '20px' }}>
          <SectionHeader>Operating Expenses by Priority ($7.3M Annualized)</SectionHeader>
          <OpExTreemapByPriority />
        </Card>
      </div>
    );

    // Page 4: Efficiency - Vertical layout (v8.3 fix)
    const EfficiencyPage = () => (
      <div className="print-page" style={{ padding: '20px 28px' }}>
        {/* Marketing Efficiency - Full width */}
        <Card style={{ marginBottom: '20px' }}>
          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '24px' }}>
            {/* Left: Variance Bars */}
            <div>
              <SectionHeader>Marketing Efficiency</SectionHeader>
              
              {/* MER Variance Bars */}
              <MERVarianceBar label="gMER" companyVal={COMPANY.gMER} cohortVal={COHORT.gMER} formula="Rev ÷ Paid Media" />
              <MERVarianceBar label="MER" companyVal={COMPANY.MER} cohortVal={COHORT.MER} formula="Rev ÷ All Mkt" />
              <MERVarianceBar label="pMER" companyVal={COMPANY.pMER} cohortVal={COHORT.pMER} formula="GP ÷ All Mkt" />
              
              {/* pMER callout */}
              <div style={{ 
                backgroundColor: LIGHT_GREEN, 
                padding: '10px 12px', 
                borderRadius: '6px',
                marginTop: '12px'
              }}>
                <div style={{ fontSize: '10px', color: GREEN, fontWeight: '600', marginBottom: '4px' }}>pMER &gt; 1.0 = Profitable marketing</div>
                <div style={{ fontSize: '11px', color: '#555' }}>
                  Flaus: $1.75 gross profit per $1 spent | Cohort: $0.88 (below breakeven)
                </div>
              </div>
            </div>
            
            {/* Right: pMER Explanation */}
            <div>
              <div style={{ fontSize: '14px', fontWeight: '700', color: TEAL, marginBottom: '12px' }}>
                pMER: Profit-Adjusted Marketing Efficiency
              </div>
              <p style={{ fontSize: '12px', lineHeight: '1.6', color: '#444', marginBottom: '12px' }}>
                Raw MER ignores margin structure. <strong style={{ color: TEAL }}>pMER answers the real question:</strong> how much gross profit do you generate per marketing dollar?
              </p>
              <div style={{ 
                backgroundColor: '#f8f9fa', 
                padding: '12px', 
                borderRadius: '6px',
                marginBottom: '12px',
                fontFamily: 'monospace'
              }}>
                <div style={{ fontSize: '12px', color: '#333', marginBottom: '4px' }}>pMER = MER × Gross Margin</div>
                <div style={{ fontSize: '12px', color: TEAL }}>Flaus: 2.65 × 66% = <strong>1.75</strong></div>
              </div>
              <p style={{ fontSize: '12px', lineHeight: '1.6', color: '#444', marginBottom: '12px' }}>
                Flaus's raw MER (2.65x) looks only marginally better than cohort (2.5x). But pMER reveals the company is <strong style={{ color: GREEN }}>2x more efficient</strong> at converting marketing spend into gross profit.
              </p>
              <div style={{ 
                backgroundColor: LIGHT_AMBER, 
                padding: '10px 12px', 
                borderRadius: '6px',
                border: `1px solid ${GOLD}`
              }}>
                <div style={{ fontSize: '11px', color: '#555' }}>
                  <strong style={{ color: GOLD }}>Breakeven:</strong> At 66% GM, Flaus breaks even at MER of 1.5x. At 35% GM, cohort needs MER of 2.9x just to break even.
                </div>
              </div>
            </div>
          </div>
        </Card>

        {/* Capital Efficiency - Full width */}
        <Card>
          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '24px' }}>
            {/* Left: Variance Bars */}
            <div>
              <SectionHeader>Capital Efficiency</SectionHeader>
              <CapitalVarianceBar label="Capital Raised ($M)" companyVal={4.6} cohortVal={3.9} unit="M" />
              <CapitalVarianceBar label="Capital Deployed ($M)" companyVal={1.6} cohortVal={3.1} unit="M" lowerIsBetter />
              <CapitalVarianceBar label="Capital Efficiency" companyVal={COMPANY.capitalEfficiency} cohortVal={COHORT.capitalEfficiency} unit="x" />
              <CapitalVarianceBar label="Growth Efficiency T12M" companyVal={COMPANY.growthEfficiencyT12M} cohortVal={COHORT.growthEfficiencyT12M} unit="" />
              
              <InsightBox lead="Cash Generative">
                Negative growth efficiency means Flaus generates cash while growing—exceptional at this stage.
              </InsightBox>
              
              {/* Formulas */}
              <div style={{ marginTop: '12px', padding: '10px', backgroundColor: '#f5f5f5', borderRadius: '6px', fontSize: '10px', color: '#666' }}>
                <div style={{ fontWeight: '600', marginBottom: '6px', color: '#555' }}>Formulas:</div>
                <div style={{ marginBottom: '3px' }}><strong>Capital Deployed</strong> = Retained Earnings + YTD Net Income (cumulative operating loss/gain)</div>
                <div style={{ marginBottom: '3px' }}><strong>Capital Efficiency</strong> = Run Rate Net Revenue ÷ Capital Deployed</div>
                <div><strong>Growth Efficiency</strong> = Revenue Growth ÷ EBITDA Loss (negative = cash generative)</div>
              </div>
            </div>
            
            {/* Right: Capital Story */}
            <div>
              <div style={{ fontSize: '14px', fontWeight: '700', color: TEAL, marginBottom: '12px' }}>
                Capital Story
              </div>
              <p style={{ fontSize: '12px', lineHeight: '1.6', color: '#444', marginBottom: '12px' }}>
                Flaus has raised <strong style={{ color: TEAL }}>$4.6M</strong> in SAFE financing and deployed only 
                <strong style={{ color: TEAL }}> $1.6M</strong> — preserving significant runway.
              </p>
              <p style={{ fontSize: '12px', lineHeight: '1.6', color: '#444', marginBottom: '12px' }}>
                <strong style={{ color: TEAL }}>Speed + Efficiency:</strong> Flaus deployed less capital ($1.6M vs $3.1M) over less time (18 mo vs 30 mo) to reach the same milestone.
              </p>
              <div style={{ 
                backgroundColor: LIGHT_AMBER, 
                padding: '12px', 
                borderRadius: '6px',
                border: `1px solid ${GOLD}`
              }}>
                <div style={{ fontSize: '11px', color: '#555' }}>
                  <strong style={{ color: GOLD }}>Cash Generative:</strong> Negative growth efficiency means Flaus generates cash while growing — exceptional at this stage. With ~$3M+ undeployed, the company has significant optionality.
                </div>
              </div>
            </div>
          </div>
        </Card>
      </div>
    );

    // Page 5: Trends
    const TrendsPage = () => (
      <div className="print-page" style={{ padding: '20px 28px' }}>
        <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '20px' }}>
          {/* Row 1: Top Line */}
          <Card>
            <SectionHeader>Net Revenue Trend</SectionHeader>
            <TrendChart 
              title="Monthly Net Revenue ($K)"
              data={MONTHLY.netRevenue}
              cohortValue={1332}
              unit="K"
              cohortLabel="Cohort"
            />
            <InsightBox lead="Revenue Growth">
              Strong June recovery to $1.48M after May dip. Trending toward milestone.
            </InsightBox>
          </Card>
          
          <Card>
            <SectionHeader>Gross Profit Trend</SectionHeader>
            <TrendChart 
              title="Monthly Gross Profit ($K)"
              data={MONTHLY.grossProfit}
              cohortValue={904}
              unit="K"
              cohortLabel="Cohort"
            />
            <InsightBox lead="Margin Stability">
              Gross profit follows revenue pattern. June GP of $1M+ demonstrates scalable unit economics.
            </InsightBox>
          </Card>

          {/* Row 2: Cost Structure - Multi-line with color-matched dots (Item 22) */}
          <Card>
            <SectionHeader>OpEx by Function Trend</SectionHeader>
            <MultiTrendChart 
              title="Monthly OpEx as % of Revenue"
              lines={[
                { label: 'S&M', data: MONTHLY.smPct },
                { label: 'Ops', data: MONTHLY.opsPct },
                { label: 'G&A', data: MONTHLY.gaPct },
              ]}
              cohorts={[
                { value: COHORT.smPct },
                { value: COHORT.operationsPct },
                { value: COHORT.gaPct },
              ]}
              unit="%"
            />
            <InsightBox lead="Cost Discipline">
              S&M as % of revenue trending down from 27% to 29%, while G&A remains remarkably flat at 4-7%.
            </InsightBox>
          </Card>
          
          <Card>
            <SectionHeader>OpEx by Priority Trend</SectionHeader>
            <MultiTrendChart 
              title="Monthly Expense Priority (% Rev)"
              lines={[
                { label: 'CAC', data: MONTHLY.cacPct },
                { label: 'Other', data: MONTHLY.otherPct },
                { label: 'Payroll', data: MONTHLY.payrollPct },
              ]}
              cohorts={[
                { value: COHORT.cacPct },
                { value: COHORT.otherOpexPct },
                { value: COHORT.payrollPct },
              ]}
              unit="%"
            />
            <InsightBox lead="Investment Mix">
              Customer acquisition dominates spend. Payroll remains extremely lean at 2-4% of revenue.
            </InsightBox>
          </Card>

          {/* Row 3: Profitability & Efficiency */}
          <Card>
            <SectionHeader>EBITDA Margin Trend</SectionHeader>
            <TrendChart 
              title="Monthly EBITDA Margin (%)"
              data={MONTHLY.ebitdaMargin}
              cohortValue={COHORT.ebitdaPct}
              unit="%"
              cohortLabel="Cohort"
            />
            <InsightBox lead="Profitability">
              Volatile but trending positive. June's 26.6% margin shows upside potential when revenue peaks.
            </InsightBox>
          </Card>
          
          <Card>
            <SectionHeader>Marketing Efficiency Trend</SectionHeader>
            <MultiTrendChart 
              title="MER / gMER / pMER"
              lines={[
                { label: 'MER', data: MONTHLY.MER },
                { label: 'gMER', data: MONTHLY.gMER },
                { label: 'pMER', data: MONTHLY.pMER },
              ]}
              cohorts={[
                { value: COHORT.MER },
                { value: COHORT.gMER },
                { value: COHORT.pMER },
              ]}
              unit="x"
              showBreakeven={true}
            />
            <InsightBox lead="pMER Above Breakeven">
              pMER consistently &gt;1.0x means profitable customer acquisition. Jan and Jun show 2x+ efficiency.
            </InsightBox>
            <div style={{ fontSize: '10px', color: '#666', marginTop: '8px', fontStyle: 'italic' }}>
              Note: gMER ≈ MER indicates nearly all marketing spend is in paid media—typical for DTC at this stage. As channels diversify (retail, wholesale), these metrics will diverge.
            </div>
          </Card>
        </div>
      </div>
    );

    // Page 6: Narrative
    const NarrativePage = () => (
      <div className="print-page" style={{ padding: '20px 28px' }}>
        <Card>
          <div style={{ fontSize: '13px', lineHeight: '1.7', color: '#333' }}>
            
            <SectionHeader>1. Executive Summary</SectionHeader>
            <p style={{ marginBottom: '16px' }}>
              Flaus demonstrates <strong style={{ color: GREEN }}>exceptional underlying performance</strong>, with several metrics showing 
              significant outperformance relative to the $15M extraordinary cohort. The company has achieved what few DTC brands accomplish 
              at this scale: <strong>profitability while maintaining strong growth</strong>.
            </p>
            <p style={{ marginBottom: '24px' }}>
              With 66% gross margins (vs. 68% cohort), 13.3% EBITDA margins (vs. 4.2% cohort), and a pMER of 1.75x, Flaus has built a 
              capital-efficient business model that generates $1.75 of gross profit for every dollar of marketing spend. This positions 
              the company with significant optionality: self-fund continued growth or raise strategically for acceleration.
            </p>

            <SectionHeader>2. Growth Performance</SectionHeader>
            <p style={{ marginBottom: '16px' }}>
              At ~$13.6M annualized revenue, Flaus is tracking toward the $15M milestone with <strong>75.8% YoY growth</strong>—objectively 
              strong performance, though below the cohort's 246% (which includes several outlier hypergrowth companies).
            </p>
            <p style={{ marginBottom: '24px' }}>
              Critically, Flaus reached this milestone in just <strong style={{ color: TEAL }}>18 months from first revenue</strong> versus the cohort average 
              of 30 months. The "lower" YoY growth reflects a later start date, not slower execution—the company is actually outpacing 
              peers on time-to-milestone.
            </p>

            <SectionHeader>3. Gross Margin Analysis</SectionHeader>
            <p style={{ marginBottom: '16px' }}>
              <strong style={{ color: GREEN }}>Gross margin of 65.9%</strong> is closely aligned with the cohort average (67.8%), indicating 
              strong product economics and pricing power. This margin profile signals premium positioning, favorable product mix, and efficient 
              supply chain operations. Critically, Flaus maintains these margins with significantly lower discounting than peers (8.3% vs. 13.1% cohort).
            </p>
            <p style={{ marginBottom: '24px' }}>
              <strong>Channel Mix Context:</strong> Current gross margin reflects DTC channel concentration, where Flaus captures full retail margin. 
              As the company expands into wholesale distribution (retail partners, dental professional channel), blended gross margin will likely compress 
              due to retailer margin requirements. However, wholesale channels typically carry significantly lower customer acquisition costs—the contribution 
              margin impact may still be neutral or accretive even with lower GM. This creates strategic optionality: trade gross margin for distribution 
              reach while potentially improving overall unit economics.
            </p>

            <SectionHeader>4. Operating Expenses</SectionHeader>
            <p style={{ marginBottom: '16px' }}>
              Total operating expenses of <strong>$7.3M (54% of revenue)</strong> reflect a lean operating model compared to the cohort's 
              60%+ typical structure.
            </p>
            <div style={{ backgroundColor: LIGHT_TEAL, padding: '12px 16px', borderRadius: '6px', marginBottom: '16px' }}>
              <div style={{ marginBottom: '6px' }}><strong>G&A:</strong> 4.5% of revenue <span style={{ color: GREEN }}>(vs. 25.5% cohort — 21 pts leaner)</span></div>
              <div style={{ marginBottom: '6px' }}><strong>S&M:</strong> 37.7% of revenue (vs. 32.9% cohort — DTC model)</div>
              <div><strong>Operations:</strong> 11.8% of revenue (vs. 5.1% cohort — fulfillment costs)</div>
            </div>
            <p style={{ marginBottom: '16px' }}>
              The G&A efficiency is exceptional—Flaus operates with a fraction of the overhead typical at this scale. However, this leanness warrants careful examination.
            </p>
            
            {/* Propeller Advisory Note - echoed from Exec Summary */}
            <div style={{ 
              padding: '14px 16px',
              backgroundColor: LIGHT_AMBER,
              border: `1px solid ${GOLD}`,
              borderRadius: '6px',
              marginBottom: '24px'
            }}>
              <div style={{ fontSize: '12px', fontWeight: '600', color: GOLD, marginBottom: '10px', display: 'flex', alignItems: 'center', gap: '6px' }}>
                <span>⚠</span> Propeller Advisory Note
              </div>
              <p style={{ fontSize: '12px', lineHeight: '1.6', color: '#555', margin: '0 0 10px 0' }}>
                As financial advisors, we note that companies at this velocity often defer investments in compliance infrastructure, transaction readiness, and data integrity. These gaps are invisible until they become urgent—typically during a fundraise, audit, or acquisition process.
              </p>
              <p style={{ fontSize: '12px', lineHeight: '1.6', color: '#555', margin: '0 0 8px 0' }}>
                Flaus's lean G&A (4.5% vs 25.5% cohort) warrants a candid assessment of what's been deferred in:
              </p>
              <ul style={{ margin: 0, paddingLeft: '20px', fontSize: '12px', lineHeight: '1.7', color: '#555' }}>
                <li><strong>Compliance:</strong> Legal, regulatory, tax infrastructure</li>
                <li><strong>Transaction readiness:</strong> Audit prep, data room quality, financial reporting rigor</li>
                <li><strong>Data integrity:</strong> Systems, controls, reconciliation processes</li>
                <li><strong>Key person risk:</strong> With payroll at 1/4 of cohort, likely heavy founder dependency</li>
              </ul>
            </div>

            <SectionHeader>5. EBITDA & Profitability</SectionHeader>
            <p style={{ marginBottom: '16px' }}>
              <strong style={{ color: GREEN }}>EBITDA of +13.3% (~$1.8M annualized)</strong> significantly outperforms the cohort median of 4.2% and exceeds the cohort maximum. 
              This is a standout result—positive and substantial EBITDA at the $15M scale in consumer/DTC is rare, and achieving it in just 
              <strong style={{ color: TEAL }}> 18 months from first revenue</strong> (vs. 30-month cohort average) makes it exceptional.
            </p>
            <p style={{ marginBottom: '24px' }}>
              <strong style={{ color: GREEN }}>Net Income of +10.5% (~$1.4M annualized)</strong> vs. cohort's 5.3% further demonstrates the 
              quality of earnings. The business is generating real profit, not just adjusted metrics. Most companies at this velocity are still 
              investing heavily in growth infrastructure—Flaus has achieved profitability while others are burning cash.
            </p>

            <SectionHeader>6. Marketing Efficiency (pMER)</SectionHeader>
            <p style={{ marginBottom: '16px' }}>
              <strong>pMER of 1.75x</strong> (Gross Profit ÷ Marketing Spend) is the key efficiency metric. This means Flaus generates 
              $1.75 in gross profit for every $1 invested in marketing—well above the 1.0x breakeven threshold.
            </p>
            <div style={{ backgroundColor: LIGHT_GREEN, padding: '12px 16px', borderRadius: '6px', marginBottom: '16px' }}>
              <div style={{ fontWeight: '600', color: GREEN, marginBottom: '6px' }}>The Gross Margin Multiplier Effect</div>
              <p style={{ fontSize: '12px', marginBottom: '6px' }}>
                At 66% GM with 2.65x MER, Flaus generates <strong>$1.75 gross profit per $1 marketing spend</strong>.
              </p>
              <p style={{ fontSize: '12px' }}>
                A cohort peer with 35% GM would need <strong>MER of 5.0x</strong> to match this profitability. Flaus's high margins act as a 
                force multiplier on marketing efficiency.
              </p>
            </div>
            <p style={{ marginBottom: '24px' }}>
              pMER volatility (ranging from 1.37x to 2.43x monthly) suggests opportunity for optimization—understanding what drives the 
              high-pMER months (Jan, Jun) could unlock significant value.
            </p>

            <SectionHeader>7. Capital Strategy & Efficiency</SectionHeader>
            <p style={{ marginBottom: '16px' }}>
              Flaus has raised <strong>$4.6M</strong> in SAFE financing and deployed only <strong>$1.6M</strong>—preserving significant runway 
              with $3M+ in reserve. Capital efficiency of 3.0x (revenue/capital raised) reflects a lean operating philosophy.
            </p>
            <p style={{ marginBottom: '24px' }}>
              <strong style={{ color: GREEN }}>Growth Efficiency of -7.3</strong> (negative = cash generative) means Flaus generates cash while 
              growing—exceptional at this stage. Most cohort peers show positive growth efficiency, meaning they consume cash to grow.
            </p>

            <SectionHeader>8. Summary Observations</SectionHeader>
            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px', marginBottom: '24px' }}>
              <div style={{ backgroundColor: LIGHT_GREEN, padding: '12px', borderRadius: '6px' }}>
                <div style={{ fontWeight: '600', color: GREEN, marginBottom: '8px' }}>Exceptional Outperformance</div>
                <ul style={{ margin: 0, paddingLeft: '16px', fontSize: '12px' }}>
                  <li>EBITDA +9 pts above cohort</li>
                  <li>Net Income +5 pts above cohort</li>
                  <li>G&A 21 pts leaner than cohort</li>
                  <li>Cash generative while growing</li>
                  <li>pMER of 1.75x (profitable acquisition)</li>
                  <li>Reached milestone 2x faster</li>
                </ul>
              </div>
              <div style={{ backgroundColor: LIGHT_AMBER, padding: '12px', borderRadius: '6px' }}>
                <div style={{ fontWeight: '600', color: AMBER, marginBottom: '8px' }}>Areas to Monitor</div>
                <ul style={{ margin: 0, paddingLeft: '16px', fontSize: '12px' }}>
                  <li>Organizational maturity at 18 months from first revenue</li>
                  <li>G&A leanness may mask infrastructure gaps</li>
                  <li>Payroll at &lt;1/4 cohort (key person risk)</li>
                  <li>pMER volatility month-to-month</li>
                  <li>Ops costs (DTC structural)</li>
                  <li>Capital deployment strategy</li>
                </ul>
              </div>
            </div>

            <SectionHeader>9. Discussion Prompts</SectionHeader>
            <ol style={{ paddingLeft: '24px', marginBottom: 0 }}>
              <li style={{ marginBottom: '8px' }}><strong>Growth Investment:</strong> Would Flaus benefit from a modest increase in S&M to accelerate growth while maintaining efficiency—or is the current capital-light approach optimal?</li>
              <li style={{ marginBottom: '8px' }}><strong>pMER Optimization:</strong> What's driving pMER volatility (1.37x–2.43x)? Can high-pMER months be replicated?</li>
              <li style={{ marginBottom: '8px' }}><strong>Channel Strategy:</strong> Wholesale distribution offers significant growth opportunity, but requires substantially more working capital. Should the company leverage its gross margin strength to expand distribution?</li>
              <li><strong>Capital Deployment:</strong> With $3M+ in undeployed capital and positive cash flow, what's the right deployment strategy?</li>
            </ol>
          </div>
        </Card>
      </div>
    );

    // Page 7: Company Info
    const CompanyInfoPage = () => (
      <div className="print-page" style={{ padding: '20px 28px' }}>
        <Card>
          <div style={{ fontSize: '13px', lineHeight: '1.7', color: '#333' }}>
            
            <SectionHeader>Company Overview</SectionHeader>
            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '20px', marginBottom: '24px' }}>
              <div>
                <div style={{ fontWeight: '600', color: TEAL, marginBottom: '8px' }}>Business Profile</div>
                <table style={{ fontSize: '12px', width: '100%' }}>
                  <tbody>
                    <tr><td style={{ padding: '4px 0', color: '#666' }}>Legal Name</td><td style={{ padding: '4px 0' }}>Flaus, Inc.</td></tr>
                    <tr><td style={{ padding: '4px 0', color: '#666' }}>Brand</td><td style={{ padding: '4px 0' }}>Flaus</td></tr>
                    <tr><td style={{ padding: '4px 0', color: '#666' }}>Category</td><td style={{ padding: '4px 0' }}>Oral Care / Personal Care Electronics</td></tr>
                    <tr><td style={{ padding: '4px 0', color: '#666' }}>Business Model</td><td style={{ padding: '4px 0' }}>DTC-first with Amazon expansion; subscription refills</td></tr>
                    <tr><td style={{ padding: '4px 0', color: '#666' }}>Year Founded</td><td style={{ padding: '4px 0' }}>2019</td></tr>
                    <tr><td style={{ padding: '4px 0', color: '#666' }}>Entity Type</td><td style={{ padding: '4px 0' }}>Public Benefit Corporation (Delaware)</td></tr>
                    <tr><td style={{ padding: '4px 0', color: '#666' }}>Headquarters</td><td style={{ padding: '4px 0' }}>New York, NY</td></tr>
                  </tbody>
                </table>
              </div>
              <div>
                <div style={{ fontWeight: '600', color: TEAL, marginBottom: '8px' }}>One-Liner</div>
                <p style={{ fontSize: '12px', fontStyle: 'italic', marginBottom: '16px' }}>
                  "The world's first eco-friendly electric flosser that makes flossing as quick, easy, and comfortable as brushing your teeth."
                </p>
                <div style={{ fontWeight: '600', color: TEAL, marginBottom: '8px' }}>Key Product</div>
                <p style={{ fontSize: '12px' }}>
                  Electric Flosser Starter Kit ($79-119) + Subscription Refills ($5/month)
                </p>
              </div>
            </div>

            <SectionHeader>Leadership</SectionHeader>
            <div style={{ marginBottom: '24px' }}>
              <div style={{ backgroundColor: LIGHT_TEAL, padding: '12px', borderRadius: '6px', marginBottom: '12px' }}>
                <div style={{ fontWeight: '600', color: TEAL }}>Samantha Coxe — Founder & CEO</div>
                <p style={{ fontSize: '12px', margin: '8px 0 0 0' }}>
                  Former M&A attorney at Skadden, Arps. NYU Law (Vanderbilt Medal). Inc. Magazine Top Female Founders 2024. 
                  Conceived Flaus in 2019 after a costly dental visit from not flossing.
                </p>
              </div>
              <div style={{ backgroundColor: LIGHT_TEAL, padding: '12px', borderRadius: '6px' }}>
                <div style={{ fontWeight: '600', color: TEAL }}>Elli Hanson — Co-Founder</div>
                <p style={{ fontSize: '12px', margin: '8px 0 0 0' }}>
                  Industrial design background. Leads branding and product design.
                </p>
              </div>
            </div>

            <SectionHeader>Capital History <span style={{ fontWeight: '400', fontSize: '11px', color: '#666' }}>(publicly disclosed)</span></SectionHeader>
            <table style={{ fontSize: '12px', width: '100%', marginBottom: '24px', borderCollapse: 'collapse' }}>
              <thead>
                <tr style={{ borderBottom: `2px solid ${GOLD}` }}>
                  <th style={{ padding: '8px', textAlign: 'left', color: TEAL }}>Round</th>
                  <th style={{ padding: '8px', textAlign: 'left', color: TEAL }}>Date</th>
                  <th style={{ padding: '8px', textAlign: 'right', color: TEAL }}>Amount</th>
                  <th style={{ padding: '8px', textAlign: 'left', color: TEAL }}>Lead Investor(s)</th>
                </tr>
              </thead>
              <tbody>
                <tr><td style={{ padding: '6px 8px' }}>Pre-Seed</td><td style={{ padding: '6px 8px' }}>2020-2021</td><td style={{ padding: '6px 8px', textAlign: 'right' }}>~$1.6M</td><td style={{ padding: '6px 8px' }}>Friends & Family</td></tr>
                <tr style={{ backgroundColor: '#f9f9f9' }}><td style={{ padding: '6px 8px' }}>Crowdfunding</td><td style={{ padding: '6px 8px' }}>June 2021</td><td style={{ padding: '6px 8px', textAlign: 'right' }}>$270K</td><td style={{ padding: '6px 8px' }}>Indiegogo</td></tr>
                <tr><td style={{ padding: '6px 8px' }}>Seed</td><td style={{ padding: '6px 8px' }}>October 2023</td><td style={{ padding: '6px 8px', textAlign: 'right' }}>$2M</td><td style={{ padding: '6px 8px' }}>YETI Capital</td></tr>
                <tr style={{ backgroundColor: '#f9f9f9' }}><td style={{ padding: '6px 8px' }}>Shark Tank</td><td style={{ padding: '6px 8px' }}>May 2024</td><td style={{ padding: '6px 8px', textAlign: 'right' }}>$250K</td><td style={{ padding: '6px 8px' }}>Candace Nelson (8% equity)</td></tr>
                <tr style={{ fontWeight: '600', borderTop: `2px solid ${GOLD}` }}><td style={{ padding: '8px' }}>Total Raised</td><td style={{ padding: '8px' }}></td><td style={{ padding: '8px', textAlign: 'right' }}>~$4.1M</td><td style={{ padding: '8px' }}></td></tr>
              </tbody>
            </table>

            <SectionHeader>Stage Context</SectionHeader>
            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px', marginBottom: '24px' }}>
              <div style={{ backgroundColor: LIGHT_TEAL, padding: '12px', borderRadius: '6px' }}>
                <div style={{ fontWeight: '600', color: TEAL, marginBottom: '8px' }}>Timeline</div>
                <table style={{ fontSize: '12px', width: '100%' }}>
                  <tbody>
                    <tr><td style={{ padding: '4px 0', color: '#666' }}>Months Since Inception</td><td style={{ padding: '4px 0', fontWeight: '600' }}>~64 months (founded 2019)</td></tr>
                    <tr><td style={{ padding: '4px 0', color: '#666' }}>Months Since First Revenue*</td><td style={{ padding: '4px 0', fontWeight: '600' }}>~18 months (from GL first revenue)</td></tr>
                    <tr><td style={{ padding: '4px 0', color: '#666' }}>Pre-Revenue R&D Phase</td><td style={{ padding: '4px 0', fontWeight: '600' }}>~2.5 years (typical for consumer hardware)</td></tr>
                  </tbody>
                </table>
              </div>
              <div style={{ backgroundColor: LIGHT_AMBER, padding: '12px', borderRadius: '6px', border: `1px solid ${GOLD}` }}>
                <div style={{ fontWeight: '600', color: AMBER, marginBottom: '8px' }}>⚠ Data Quality Note</div>
                <p style={{ fontSize: '11px', marginBottom: '8px' }}>
                  GL migrated to QuickBooks in January 2024. QFR "first transaction" reflects GL start date, not company founding.
                </p>
                <p style={{ fontSize: '11px', marginBottom: '8px' }}>
                  *Indiegogo shipments (Aug 2022) treated as pre-launch proof of concept, not commercial first revenue. 
                  This analysis uses GL first revenue as the time anchor for cohort comparison.
                </p>
                <p style={{ fontSize: '11px', margin: 0 }}>
                  <strong>"Months from first revenue"</strong> = months from first revenue recorded in GL.
                </p>
              </div>
            </div>

            <SectionHeader>RMF Cohort Selection</SectionHeader>
            <div style={{ backgroundColor: '#f5f5f5', padding: '16px', borderRadius: '6px' }}>
              <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '20px' }}>
                <div>
                  <div style={{ fontWeight: '600', color: TEAL, marginBottom: '8px' }}>Cohort Assigned</div>
                  <p style={{ fontSize: '12px', marginBottom: '4px' }}><strong>$15M Milestone — Extraordinary Cohort</strong></p>
                  <p style={{ fontSize: '11px', color: '#666' }}>Top-decile performers at this revenue stage</p>
                </div>
                <div>
                  <div style={{ fontWeight: '600', color: TEAL, marginBottom: '8px' }}>Selection Rationale</div>
                  <ul style={{ fontSize: '11px', margin: 0, paddingLeft: '16px', color: '#666' }}>
                    <li>Consumer products / DTC category alignment</li>
                    <li>Hardware with subscription model</li>
                    <li>Venture-backed growth stage</li>
                    <li>Revenue milestone match (~$13.6M annualized)</li>
                  </ul>
                </div>
              </div>
            </div>

          </div>
        </Card>
      </div>
    );

    // ============================================================================
    // MAIN DASHBOARD
    // ============================================================================
    const Dashboard = () => {
      const [activePage, setActivePage] = React.useState(1);
      const [isPrinting, setIsPrinting] = React.useState(false);

      const handlePrint = () => {
        setIsPrinting(true);
        setTimeout(() => {
          window.print();
          setIsPrinting(false);
        }, 100);
      };

      const pages = ['Overview', 'P&L Variance', 'Analytics', 'Efficiency', 'Trends', 'Narrative', 'Company Info'];

      return (
        <div style={{ minHeight: '100vh', backgroundColor: '#f5f5f5' }}>
          {/* Header */}
          <div className="print-header" style={{ 
            backgroundColor: TEAL, 
            color: 'white', 
            padding: '20px 28px',
            display: 'flex',
            justifyContent: 'space-between',
            alignItems: 'center'
          }}>
            <div>
              <div style={{ fontSize: '10px', opacity: 0.7, letterSpacing: '2px', marginBottom: '2px' }}>REVENUE MILESTONE FRAMEWORK</div>
              <div style={{ fontSize: '24px', fontWeight: 'bold' }}>{COMPANY.fullName}</div>
              <div style={{ fontSize: '12px', opacity: 0.8, marginTop: '2px' }}>{COMPANY.milestone} Milestone Cohort Comparison</div>
            </div>
            <div style={{ textAlign: 'right' }}>
              <div style={{ fontSize: '10px', opacity: 0.7, letterSpacing: '1px' }}>PROPELLER INDUSTRIES</div>
              <div style={{ fontSize: '9px', opacity: 0.6, marginTop: '2px' }}>Financial Operating Platform</div>
              <div style={{ fontSize: '9px', opacity: 0.5, marginTop: '4px' }}>{COMPANY.analysisDate}</div>
            </div>
          </div>

          {/* Metrics Strip - Outlined style (Item 7) */}
          <div className="print-metrics" style={{ 
            display: 'flex', 
            gap: '10px', 
            padding: '16px 28px',
            backgroundColor: 'white',
            borderBottom: `3px solid ${GOLD}`
          }}>
            <MetricCard label="Net Revenue" value="$13.6M" subtext="annualized" performance="neutral" />
            <MetricCard label="Gross Margin" value="65.9%" subtext="vs 67.8% cohort" performance="neutral" />
            <MetricCard label="EBITDA" value="+13.3%" subtext="vs 4.2% cohort" performance="good" />
            <MetricCard label="Net Income" value="+10.5%" subtext="vs 5.3% cohort" performance="good" />
            <MetricCard label="YoY Growth" value="75.8%" subtext="vs 246% cohort" performance="bad" />
            <MetricCard label="pMER" value="1.75x" subtext="vs 1.0 breakeven" performance="good" />
            <MetricCard label="Time to Milestone" value="18 mo" subtext="vs 30 mo cohort" performance="good" />
          </div>

          {/* Navigation */}
          <div className="no-print" style={{ display: 'flex', gap: '8px', padding: '12px 28px', backgroundColor: '#eee', alignItems: 'center' }}>
            {pages.map((label, i) => (
              <button 
                key={i}
                onClick={() => setActivePage(i + 1)}
                style={{
                  padding: '8px 16px',
                  border: 'none',
                  borderRadius: '4px',
                  backgroundColor: activePage === i + 1 ? TEAL : 'white',
                  color: activePage === i + 1 ? 'white' : '#666',
                  fontSize: '12px',
                  fontWeight: '600',
                  cursor: 'pointer'
                }}
              >
                {label}
              </button>
            ))}
            <div style={{ flex: 1 }} />
            <button 
              onClick={handlePrint}
              style={{
                padding: '8px 16px',
                border: `1px solid ${TEAL}`,
                borderRadius: '4px',
                backgroundColor: 'white',
                color: TEAL,
                fontSize: '12px',
                fontWeight: '600',
                cursor: 'pointer'
              }}
            >
              🖨️ Print All
            </button>
          </div>

          {/* Page Content */}
          {isPrinting ? (
            <>
              <OverviewPage />
              <PLVariancePage />
              <AnalyticsPage />
              <EfficiencyPage />
              <TrendsPage />
              <NarrativePage />
              <CompanyInfoPage />
            </>
          ) : (
            <>
              {activePage === 1 && <OverviewPage />}
              {activePage === 2 && <PLVariancePage />}
              {activePage === 3 && <AnalyticsPage />}
              {activePage === 4 && <EfficiencyPage />}
              {activePage === 5 && <TrendsPage />}
              {activePage === 6 && <NarrativePage />}
              {activePage === 7 && <CompanyInfoPage />}
            </>
          )}

          {/* Footer */}
          <div className="print-footer" style={{ 
            padding: '14px 28px', 
            backgroundColor: LIGHT_TEAL,
            textAlign: 'center',
            marginTop: '12px'
          }}>
            <div style={{ fontSize: '11px', fontStyle: 'italic', color: TEAL }}>
              Powered by the Propeller Intelligence Engine (PIE) and Revenue Milestone Framework (RMF)
            </div>
            <div style={{ fontSize: '10px', color: '#666', marginTop: '2px' }}>
              Benchmarking context from 1,300+ companies
            </div>
          </div>
        </div>
      );
    };

    ReactDOM.render(<Dashboard />, document.getElementById('root'));
  </script>
</body>
</html>
