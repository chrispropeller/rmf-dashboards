<!DOCTYPE html>
<!--
  RMF DASHBOARD TEMPLATE v1
  =========================
  This is an anonymized reference template based on a production dashboard.
  
  TO USE:
  1. Replace COMPANY data object with actual client values
  2. Replace COHORT data object with matching milestone cohort
  3. Replace MONTHLY data with actual trend data
  4. Update Company Info tab with client details
  5. Customize narrative sections for client context
  6. Rename file: RMF_DASH_[CODE]_YYMMDD.rev.html
  
  See: SKILL_RMF_Dashboard_v4.md for build instructions
  See: RULES_RMF_PromptKit_v1.1.md for analytical rules
-->
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NOWADAYS - RMF Dashboard | December 2025</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f5f5f5; }
    
    @media print {
      body { background: white; margin: 0; padding: 0; }
      .no-print { display: none !important; }
      .print-page { page-break-after: always; page-break-inside: avoid; }
      .print-page:last-child { page-break-after: avoid; }
      .print-footer { page-break-before: avoid; page-break-inside: avoid; margin-top: 0; }
      .print-header { page-break-after: avoid; }
      .print-metrics { page-break-after: avoid; page-break-inside: avoid; }
      * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
      
      /* Prevent orphan blank pages */
      html, body { height: auto; }
    }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    // ============================================================================
    // CONSTANTS
    // ============================================================================
    const TEAL = '#1E4D5C';
    const GOLD = '#C9A227';
    const LIGHT_TEAL = '#E8F0F2';
    const GREEN = '#2E7D32';
    const RED = '#C62828';
    const AMBER = '#F59E0B';
    const LIGHT_GREEN = '#E8F5E9';
    const LIGHT_AMBER = '#FFF8E1';

    // Company Data - NOWADAYS (Jun-Jul-Aug 2025 Annualized)
    const COMPANY = {
      name: 'NOWADAYS',
      code: 'NWDY',
      fullName: 'Disruptive Beverage Inc. (NWDY)',
      milestone: '$60M',
      analysisDate: 'December 2025',
      
      // P&L Metrics (annualized, $K)
      grossRevenue: 59307,
      discounts: 1396,
      tradeDeductions: 0,
      netRevenue: 57795,
      cogs: 19490,
      grossProfit: 38305,
      totalOpex: 35059,
      ga: 15562,
      sm: 12570,
      operations: 6927,
      ebitda: 3246,
      netIncome: 3289,
      
      // OpEx by Priority
      payroll: 10038,
      customerAcquisition: 6262,
      otherOpex: 18759,
      
      // Percentages
      grossRevenuePct: 102.6,
      discountsPct: 2.4,
      tradeDeductionsPct: 0.0,
      grossMarginPct: 66.3,
      gaPct: 26.9,
      smPct: 21.7,
      operationsPct: 12.0,
      ebitdaPct: 5.6,
      netIncomePct: 5.7,
      payrollPct: 17.4,
      cacPct: 10.8,
      otherOpexPct: 32.5,
      
      // Growth
      qoqGrowth: 7.4,
      yoyGrowth: 57.7,
      
      // Capital
      capitalRaised: 9114,
      capitalDeployed: 2802,
      capitalEfficiency: 20.6,
      growthEfficiencyT12M: 10.3,
      
      // Marketing Efficiency
      paidMedia: 6262,
      totalMarketing: 12377,
      gMER: 9.23,
      MER: 4.67,
      pMER: 3.09,
      
      // Time (from benchmark)
      monthsSinceStart: 44,
      monthsToMilestone: 32,
    };

    // Cohort Data ($60M Top-Decile Performers)
    const COHORT = {
      netRevenue: 62435,
      grossRevenuePct: 120.9,
      discountsPct: 5.2,
      tradeDeductionsPct: 11.5,
      grossMarginPct: 36.5,
      gaPct: 24.8,
      smPct: 43.0,
      operationsPct: 22.1,
      ebitdaPct: -53.5,
      otherExpensesPct: 1.0,
      netIncomePct: -54.2,
      payrollPct: 17.5,
      cacPct: 8.4,
      otherOpexPct: 64.0,
      
      qoqGrowth: 32.0,
      yoyGrowth: 63.1,
      
      capitalRaised: 95483,
      capitalDeployed: 55722,
      capitalEfficiency: 1.3,
      growthEfficiencyT12M: -0.1,
      
      gMER: 11.85,
      MER: 2.32,
      pMER: 0.85,
      
      monthsSinceStart: 48,
      monthsToMilestone: 44,
    };

    // Monthly trend data (Apr-Sep 2025, in $K)
    const MONTHLY = {
      months: ['Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep'],
      netRevenue: [4127.1, 4038.9, 5048.3, 5011.5, 4388.9, 4858.3],
      grossProfit: [2562.3, 2297.8, 3096.8, 3439.0, 3040.3, 3505.6],
      ga: [1187.6, 1269.0, 1069.6, 1379.9, 1441.0, 1308.7],
      sm: [949.4, 2100.2, 995.4, 1256.4, 890.7, 1009.5],
      operations: [540.8, 529.1, 554.6, 634.7, 542.4, 539.6],
      payroll: [753.2, 791.9, 690.2, 902.0, 917.3, 904.3],
      advertising: [891.9, 1516.9, 440.4, 644.9, 480.2, 596.0],
      totalOpex: [2677.8, 3898.3, 2619.7, 3271.0, 2874.0, 2857.8],
      ebitda: [-115.5, -1600.5, 477.0, 168.0, 166.3, 647.8],
      netIncome: [-111.7, -1598.6, 486.6, 170.0, 165.8, 649.5],
    };

    // Calculate MER metrics monthly
    MONTHLY.gMER = MONTHLY.netRevenue.map((rev, i) => rev / MONTHLY.advertising[i]);
    MONTHLY.MER = MONTHLY.netRevenue.map((rev, i) => rev / MONTHLY.sm[i]);
    MONTHLY.pMER = MONTHLY.grossProfit.map((gp, i) => gp / MONTHLY.sm[i]);
    MONTHLY.ebitdaMargin = MONTHLY.ebitda.map((eb, i) => (eb / MONTHLY.netRevenue[i]) * 100);
    MONTHLY.grossMargin = MONTHLY.grossProfit.map((gp, i) => (gp / MONTHLY.netRevenue[i]) * 100);

    // OpEx as % of revenue monthly
    MONTHLY.gaPct = MONTHLY.ga.map((g, i) => (g / MONTHLY.netRevenue[i]) * 100);
    MONTHLY.smPct = MONTHLY.sm.map((s, i) => (s / MONTHLY.netRevenue[i]) * 100);
    MONTHLY.opsPct = MONTHLY.operations.map((o, i) => (o / MONTHLY.netRevenue[i]) * 100);
    MONTHLY.payrollPct = MONTHLY.payroll.map((p, i) => (p / MONTHLY.netRevenue[i]) * 100);
    MONTHLY.cacPct = MONTHLY.advertising.map((a, i) => (a / MONTHLY.netRevenue[i]) * 100);
    MONTHLY.otherPct = MONTHLY.months.map((_, i) => {
      const other = MONTHLY.totalOpex[i] - MONTHLY.payroll[i] - MONTHLY.advertising[i];
      return (other / MONTHLY.netRevenue[i]) * 100;
    });

    // ============================================================================
    // REUSABLE COMPONENTS
    // ============================================================================

    // Metric Card - OUTLINED STYLE (Item 7)
    const MetricCard = ({ label, value, subtext, performance }) => {
      const colors = {
        good: GREEN,
        bad: RED,
        neutral: GOLD
      };
      const borderColor = performance ? colors[performance] : TEAL;
      
      return (
        <div style={{
          backgroundColor: 'white',
          border: `2px solid ${borderColor}`,
          padding: '14px 12px',
          borderRadius: '8px',
          textAlign: 'center',
          flex: 1,
          minWidth: '90px'
        }}>
          <div style={{ fontSize: '9px', color: '#666', marginBottom: '6px', textTransform: 'uppercase', letterSpacing: '0.5px' }}>{label}</div>
          <div style={{ fontSize: '20px', fontWeight: 'bold', color: borderColor }}>{value}</div>
          {subtext && <div style={{ fontSize: '9px', color: '#888', marginTop: '4px' }}>{subtext}</div>}
        </div>
      );
    };

    // Variance Bar with badge support (Item 3)
    const VarianceBar = ({ label, companyPct, cohortPct, companyLabel = "NWDY", cohortLabel = "Cohort", lowerIsBetter = false, badge = null }) => {
      const isPositive = lowerIsBetter ? companyPct < cohortPct : companyPct > cohortPct;
      const delta = Math.abs(companyPct - cohortPct).toFixed(1);
      const maxPct = Math.max(Math.abs(companyPct), Math.abs(cohortPct), 1);
      const scale = 75 / maxPct;
      
      return (
        <div style={{ marginBottom: '14px' }}>
          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '4px' }}>
            <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
              <span style={{ fontSize: '12px', fontWeight: '600', color: '#333' }}>{label}</span>
              {badge && (
                <span style={{ 
                  fontSize: '9px', 
                  padding: '2px 6px', 
                  borderRadius: '10px',
                  backgroundColor: badge === 'above max' ? LIGHT_GREEN : LIGHT_AMBER,
                  color: badge === 'above max' ? GREEN : AMBER,
                  fontWeight: '600'
                }}>
                  {badge}
                </span>
              )}
            </div>
            <span style={{ fontSize: '11px', color: isPositive ? GREEN : RED, fontWeight: '600' }}>
              {isPositive ? '▲' : '▼'} {delta} pts
            </span>
          </div>
          <div style={{ display: 'flex', gap: '8px', alignItems: 'center' }}>
            <div style={{ flex: 1 }}>
              <div style={{ display: 'flex', alignItems: 'center', marginBottom: '3px' }}>
                <div style={{ width: '50px', fontSize: '10px', color: '#666' }}>{companyLabel}</div>
                <div style={{ flex: 1, backgroundColor: '#eee', height: '20px', borderRadius: '3px', overflow: 'hidden' }}>
                  <div style={{ 
                    width: `${Math.min(Math.abs(companyPct) * scale, 100)}%`, 
                    backgroundColor: TEAL, 
                    height: '100%',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'flex-end',
                    paddingRight: '8px',
                    minWidth: '45px'
                  }}>
                    <span style={{ color: 'white', fontSize: '11px', fontWeight: '600' }}>{companyPct.toFixed(1)}%</span>
                  </div>
                </div>
              </div>
              <div style={{ display: 'flex', alignItems: 'center' }}>
                <div style={{ width: '50px', fontSize: '10px', color: '#666' }}>{cohortLabel}</div>
                <div style={{ flex: 1, backgroundColor: '#eee', height: '20px', borderRadius: '3px', overflow: 'hidden' }}>
                  <div style={{ 
                    width: `${Math.min(Math.abs(cohortPct) * scale, 100)}%`, 
                    backgroundColor: GOLD, 
                    height: '100%',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'flex-end',
                    paddingRight: '8px',
                    minWidth: '45px'
                  }}>
                    <span style={{ color: 'white', fontSize: '11px', fontWeight: '600' }}>{cohortPct.toFixed(1)}%</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      );
    };

    // Capital Variance Bar (for non-percentage metrics)
    const CapitalVarianceBar = ({ label, companyVal, cohortVal, unit = "", lowerIsBetter = false }) => {
      // Special case: Growth Efficiency - negative is GOOD (capital-efficient)
      let isPositive;
      if (label.includes('Growth Efficiency') && companyVal < 0) {
        isPositive = true; // Negative growth efficiency = capital-efficient = GOOD
      } else {
        isPositive = lowerIsBetter ? companyVal < cohortVal : companyVal > cohortVal;
      }
      const maxVal = Math.max(Math.abs(companyVal), Math.abs(cohortVal), 0.1);
      const scale = 75 / maxVal;
      
      // Special case for growth efficiency
      const deltaText = label.includes('Growth Efficiency') && companyVal < 0 
        ? 'Cash Generative' 
        : `${Math.abs(companyVal - cohortVal).toFixed(1)}${unit}`;
      
      return (
        <div style={{ marginBottom: '14px' }}>
          <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '4px' }}>
            <span style={{ fontSize: '12px', fontWeight: '600', color: '#333' }}>{label}</span>
            <span style={{ fontSize: '11px', color: isPositive ? GREEN : RED, fontWeight: '600' }}>
              {isPositive ? '▲' : '▼'} {deltaText}
            </span>
          </div>
          <div style={{ display: 'flex', gap: '8px', alignItems: 'center' }}>
            <div style={{ flex: 1 }}>
              <div style={{ display: 'flex', alignItems: 'center', marginBottom: '3px' }}>
                <div style={{ width: '50px', fontSize: '10px', color: '#666' }}>NWDY</div>
                <div style={{ flex: 1, backgroundColor: '#eee', height: '20px', borderRadius: '3px', overflow: 'hidden' }}>
                  <div style={{ 
                    width: `${Math.min(Math.abs(companyVal) * scale, 100)}%`, 
                    backgroundColor: TEAL, 
                    height: '100%',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'flex-end',
                    paddingRight: '8px',
                    minWidth: '50px'
                  }}>
                    <span style={{ color: 'white', fontSize: '11px', fontWeight: '600' }}>{companyVal.toFixed(1)}{unit}</span>
                  </div>
                </div>
              </div>
              <div style={{ display: 'flex', alignItems: 'center' }}>
                <div style={{ width: '50px', fontSize: '10px', color: '#666' }}>Cohort</div>
                <div style={{ flex: 1, backgroundColor: '#eee', height: '20px', borderRadius: '3px', overflow: 'hidden' }}>
                  <div style={{ 
                    width: `${Math.min(Math.abs(cohortVal) * scale, 100)}%`, 
                    backgroundColor: GOLD, 
                    height: '100%',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'flex-end',
                    paddingRight: '8px',
                    minWidth: '50px'
                  }}>
                    <span style={{ color: 'white', fontSize: '11px', fontWeight: '600' }}>{cohortVal.toFixed(1)}{unit}</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      );
    };

    // MER Variance Bar (for x metrics)
    const MERVarianceBar = ({ label, companyVal, cohortVal, formula }) => {
      const isPositive = companyVal > cohortVal;
      const maxVal = Math.max(companyVal, cohortVal, 0.1);
      const scale = 75 / maxVal;
      
      return (
        <div style={{ marginBottom: '14px' }}>
          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '4px' }}>
            <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
              <span style={{ fontSize: '12px', fontWeight: '600', color: '#333' }}>{label}</span>
              <span style={{ fontSize: '9px', color: '#888' }}>({formula})</span>
            </div>
            <span style={{ fontSize: '11px', color: isPositive ? GREEN : RED, fontWeight: '600' }}>
              {isPositive ? '▲' : '▼'} {Math.abs(companyVal - cohortVal).toFixed(2)}x
            </span>
          </div>
          <div style={{ display: 'flex', gap: '8px', alignItems: 'center' }}>
            <div style={{ flex: 1 }}>
              <div style={{ display: 'flex', alignItems: 'center', marginBottom: '3px' }}>
                <div style={{ width: '50px', fontSize: '10px', color: '#666' }}>NWDY</div>
                <div style={{ flex: 1, backgroundColor: '#eee', height: '20px', borderRadius: '3px', overflow: 'hidden' }}>
                  <div style={{ 
                    width: `${Math.min(companyVal * scale, 100)}%`, 
                    backgroundColor: TEAL, 
                    height: '100%',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'flex-end',
                    paddingRight: '8px',
                    minWidth: '45px'
                  }}>
                    <span style={{ color: 'white', fontSize: '11px', fontWeight: '600' }}>{companyVal.toFixed(2)}x</span>
                  </div>
                </div>
              </div>
              <div style={{ display: 'flex', alignItems: 'center' }}>
                <div style={{ width: '50px', fontSize: '10px', color: '#666' }}>Cohort</div>
                <div style={{ flex: 1, backgroundColor: '#eee', height: '20px', borderRadius: '3px', overflow: 'hidden' }}>
                  <div style={{ 
                    width: `${Math.min(cohortVal * scale, 100)}%`, 
                    backgroundColor: GOLD, 
                    height: '100%',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'flex-end',
                    paddingRight: '8px',
                    minWidth: '45px'
                  }}>
                    <span style={{ color: 'white', fontSize: '11px', fontWeight: '600' }}>{cohortVal.toFixed(2)}x</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      );
    };

    const Card = ({ children, style = {} }) => (
      <div style={{ 
        backgroundColor: 'white', 
        borderRadius: '8px', 
        padding: '18px 20px',
        boxShadow: '0 1px 3px rgba(0,0,0,0.08)',
        ...style
      }}>
        {children}
      </div>
    );

    const SectionHeader = ({ children }) => (
      <div style={{ 
        fontWeight: '600', 
        color: TEAL,
        fontSize: '14px',
        marginBottom: '16px',
        paddingBottom: '8px',
        borderBottom: `2px solid ${GOLD}`
      }}>
        {children}
      </div>
    );

    const InsightBox = ({ lead, children }) => (
      <div style={{ 
        marginTop: '12px', 
        padding: '10px 12px', 
        backgroundColor: LIGHT_TEAL, 
        borderRadius: '6px', 
        fontSize: '11px', 
        color: '#555',
        lineHeight: '1.5'
      }}>
        <strong style={{ color: TEAL }}>{lead}:</strong> {children}
      </div>
    );

    const CalloutBox = ({ type, title, children }) => {
      const styles = {
        strength: { bg: LIGHT_GREEN, border: GREEN, icon: '✓' },
        warning: { bg: LIGHT_AMBER, border: AMBER, icon: '⚠' },
        strategic: { bg: LIGHT_TEAL, border: TEAL, icon: '→' },
      };
      const s = styles[type] || styles.strategic;
      
      return (
        <div style={{ 
          backgroundColor: s.bg, 
          border: `2px solid ${s.border}`,
          borderRadius: '8px',
          padding: '14px 16px',
          marginBottom: '16px'
        }}>
          <div style={{ 
            fontSize: '13px', 
            fontWeight: '600', 
            color: s.border, 
            marginBottom: '10px',
            display: 'flex',
            alignItems: 'center',
            gap: '8px'
          }}>
            <span>{s.icon}</span> {title}
          </div>
          <div style={{ fontSize: '12px', color: '#444', lineHeight: '1.6' }}>
            {children}
          </div>
        </div>
      );
    };

    // ============================================================================
    // SANKEY CHART - Restored from v6 with bezier flows + % labels
    // ============================================================================
    const SankeyChart = () => {
      const width = 540;
      const height = 290;
      
      // Values in $000s
      const grossRev = 14776;
      const discounts = 1197;
      const netRev = 13579;
      const cogs = 4635;
      const grossProfit = 8944;
      const sm = 5120;
      const ops = 1404;
      const ga = 617;
      const ebitda = 1803;
      const other = 373;
      const netIncome = 1430;
      
      const scale = 0.016;
      
      const col1 = 25;
      const col2 = 130;
      const col3 = 235;
      const col4 = 355;
      const col5 = 455;
      
      const nodeW = 12;
      const topY = 28;
      
      const hGrossRev = grossRev * scale;
      const hDiscounts = discounts * scale;
      const hNetRev = netRev * scale;
      const hCogs = cogs * scale;
      const hGrossProfit = grossProfit * scale;
      const hSm = sm * scale;
      const hOps = ops * scale;
      const hGa = ga * scale;
      const hEbitda = ebitda * scale;
      const hOther = other * scale;
      const hNetIncome = netIncome * scale;

      // Bezier curve for flow
      const flowPath = (x1, y1, h1, x2, y2, h2) => {
        const mx = (x1 + x2) / 2;
        return `M${x1},${y1} C${mx},${y1} ${mx},${y2} ${x2},${y2} L${x2},${y2+h2} C${mx},${y2+h2} ${mx},${y1+h1} ${x1},${y1+h1} Z`;
      };

      return (
        <svg viewBox={`0 0 ${width} ${height}`} style={{ width: '100%', height: 'auto', overflow: 'hidden', display: 'block' }}>
          
          {/* === FLOWS === */}
          <path d={flowPath(col1+nodeW, topY, hNetRev, col2, topY, hNetRev)} fill={TEAL} opacity="0.25" />
          <path d={flowPath(col1+nodeW, topY + hNetRev, hDiscounts, col2-15, topY + hNetRev + 8, hDiscounts)} fill="#E57373" opacity="0.4" />
          <path d={flowPath(col2+nodeW, topY, hGrossProfit, col3, topY, hGrossProfit)} fill={TEAL} opacity="0.25" />
          <path d={flowPath(col2+nodeW, topY + hGrossProfit, hCogs, col3-15, topY + hGrossProfit + 8, hCogs)} fill="#E57373" opacity="0.4" />
          <path d={flowPath(col3+nodeW, topY, hEbitda, col4, topY, hEbitda)} fill="#4CAF50" opacity="0.3" />
          <path d={flowPath(col3+nodeW, topY + hEbitda, hSm, col4-15, topY + hEbitda + 6, hSm)} fill="#E57373" opacity="0.35" />
          <path d={flowPath(col3+nodeW, topY + hEbitda + hSm, hOps, col4-15, topY + hEbitda + hSm + 8, hOps)} fill="#E57373" opacity="0.35" />
          <path d={flowPath(col3+nodeW, topY + hEbitda + hSm + hOps, hGa, col4-15, topY + hEbitda + hSm + hOps + 10, hGa)} fill="#E57373" opacity="0.35" />
          <path d={flowPath(col4+nodeW, topY, hNetIncome, col5, topY, hNetIncome)} fill="#4CAF50" opacity="0.3" />
          <path d={flowPath(col4+nodeW, topY + hNetIncome, hOther, col5-12, topY + hNetIncome + 6, hOther)} fill="#E57373" opacity="0.35" />
          
          {/* === NODES === */}
          
          {/* Gross Revenue */}
          <rect x={col1} y={topY} width={nodeW} height={hGrossRev} fill={TEAL} rx="2" />
          <text x={col1} y={topY-14} fontSize="9" fill={TEAL} fontWeight="600">Gross Revenue</text>
          <text x={col1} y={topY-3} fontSize="10" fill={TEAL} fontWeight="700">$59.3M</text>
          <text x={col1+nodeW+4} y={topY+12} fontSize="8" fill="#666">109%</text>
          
          {/* Discounts sink */}
          <rect x={col2-15} y={topY + hNetRev + 8} width={8} height={hDiscounts} fill="#E57373" rx="2" />
          <text x={col2-4} y={topY + hNetRev + 18} fontSize="7" fill="#C62828">Disc ($1.4M)</text>
          
          {/* Net Revenue */}
          <rect x={col2} y={topY} width={nodeW} height={hNetRev} fill={TEAL} rx="2" />
          <text x={col2} y={topY-14} fontSize="9" fill={TEAL} fontWeight="600">Net Revenue</text>
          <text x={col2} y={topY-3} fontSize="10" fill={TEAL} fontWeight="700">$57.8M</text>
          <text x={col2+nodeW+4} y={topY+12} fontSize="8" fill="#666">100%</text>
          
          {/* COGS sink */}
          <rect x={col3-15} y={topY + hGrossProfit + 8} width={8} height={hCogs} fill="#E57373" rx="2" />
          <text x={col3-4} y={topY + hGrossProfit + 18} fontSize="7" fill="#C62828">COGS ($19.5M)</text>
          
          {/* Gross Profit */}
          <rect x={col3} y={topY} width={nodeW} height={hGrossProfit} fill="#4CAF50" rx="2" />
          <text x={col3} y={topY-14} fontSize="9" fill="#2E7D32" fontWeight="600">Gross Profit</text>
          <text x={col3} y={topY-3} fontSize="10" fill="#2E7D32" fontWeight="700">$38.3M</text>
          <text x={col3+nodeW+4} y={topY+12} fontSize="8" fill="#666">66%</text>
          
          {/* OpEx sinks - stacked */}
          <rect x={col4-15} y={topY + hEbitda + 6} width={8} height={hSm} fill="#E57373" rx="2" />
          <text x={col4-4} y={topY + hEbitda + 20} fontSize="7" fill="#C62828" fontWeight="600">S&M ($12.6M)</text>
          
          <rect x={col4-15} y={topY + hEbitda + hSm + 8} width={8} height={hOps} fill="#E57373" rx="2" />
          <text x={col4-4} y={topY + hEbitda + hSm + 18} fontSize="7" fill="#C62828">Ops ($6.9M)</text>
          
          <rect x={col4-15} y={topY + hEbitda + hSm + hOps + 10} width={8} height={hGa} fill="#E57373" rx="2" />
          <text x={col4-4} y={topY + hEbitda + hSm + hOps + 18} fontSize="7" fill="#C62828">G&A ($15.6M)</text>
          
          {/* EBITDA */}
          <rect x={col4} y={topY} width={nodeW} height={hEbitda} fill="#4CAF50" rx="2" />
          <text x={col4} y={topY-14} fontSize="9" fill="#2E7D32" fontWeight="600">EBITDA</text>
          <text x={col4} y={topY-3} fontSize="10" fill="#2E7D32" fontWeight="700">$1.8M</text>
          <text x={col4+nodeW+4} y={topY+12} fontSize="8" fill="#666">6%</text>
          
          {/* Other sink */}
          <rect x={col5-12} y={topY + hNetIncome + 6} width={6} height={hOther} fill="#E57373" rx="1" />
          <text x={col5-4} y={topY + hNetIncome + 14} fontSize="7" fill="#C62828">Other ($0.1M)</text>
          
          {/* Net Income */}
          <rect x={col5} y={topY} width={nodeW} height={hNetIncome} fill="#4CAF50" rx="2" />
          <text x={col5} y={topY-14} fontSize="9" fill="#2E7D32" fontWeight="600">Net Income</text>
          <text x={col5} y={topY-3} fontSize="10" fill="#2E7D32" fontWeight="700">$3.3M</text>
          <text x={col5+nodeW+4} y={topY+12} fontSize="8" fill="#666">6%</text>
        </svg>
      );
    };

    // ============================================================================
    // WATERFALL CHART - Restored from v6
    // ============================================================================
    const WaterfallChart = () => {
      const maxVal = 65000;
      const chartHeight = 180;
      const barWidth = 48;
      const gap = 8;
      
      const data = [
        { label: 'Gross Rev', value: 59307, bottom: 0, type: 'revenue', showValue: true },
        { label: 'Discounts', value: 1396, bottom: 59307 - 1396, type: 'negative', showValue: false },
        { label: 'Net Rev', value: 57795, bottom: 0, type: 'revenue', showValue: true },
        { label: 'COGS', value: 19490, bottom: 38305, type: 'negative', showValue: false },
        { label: 'Gross Profit', value: 38305, bottom: 0, type: 'profit', showValue: true },
        { label: 'G&A', value: 15562, bottom: 38305 - 15562, type: 'negative', showValue: false },
        { label: 'S&M', value: 12570, bottom: 38305 - 15562 - 12570, type: 'negative', showValue: false },
        { label: 'Ops', value: 6927, bottom: 3246, type: 'negative', showValue: false },
        { label: 'EBITDA', value: 3246, bottom: 0, type: 'profit', showValue: true },
      ];

      const getY = (val) => chartHeight - (val / maxVal) * chartHeight;
      const getHeight = (val) => (val / maxVal) * chartHeight;
      const chartWidth = data.length * (barWidth + gap) + 50;
      
      const getColor = (type) => {
        if (type === 'negative') return '#E57373';
        if (type === 'profit') return '#4CAF50';
        return TEAL;
      };

      return (
        <div style={{ marginTop: '4px' }}>
          <svg width="100%" viewBox={`0 0 ${chartWidth} ${chartHeight + 45}`} style={{ maxWidth: chartWidth, overflow: 'visible' }}>
            <text x="5" y="12" fontSize="9" fill="#999">$65M</text>
            <text x="5" y={chartHeight * 0.5 + 4} fontSize="9" fill="#999">$32M</text>
            <text x="5" y={chartHeight + 4} fontSize="9" fill="#999">$0</text>
            
            <line x1="40" y1={chartHeight} x2={chartWidth - 10} y2={chartHeight} stroke="#ddd" />
            <line x1="40" y1={chartHeight * 0.5} x2={chartWidth - 10} y2={chartHeight * 0.5} stroke="#eee" strokeDasharray="4" />
            
            {data.map((item, i) => {
              const x = 45 + i * (barWidth + gap);
              const barHeight = getHeight(item.value);
              const y = getY(item.bottom + item.value);
              const color = getColor(item.type);
              
              return (
                <g key={i}>
                  <rect x={x} y={y} width={barWidth} height={barHeight} fill={color} rx="3" />
                  
                  {item.showValue && (
                    <text x={x + barWidth/2} y={y - 6} fontSize="10" fontWeight="600" fill={color} textAnchor="middle">
                      ${(item.value/1000).toFixed(1)}M
                    </text>
                  )}
                  
                  <text 
                    x={x + barWidth/2} 
                    y={chartHeight + 14} 
                    fontSize="9" 
                    fill={item.type !== 'negative' ? getColor(item.type) : '#666'}
                    fontWeight={item.type !== 'negative' ? '600' : '400'}
                    textAnchor="middle"
                  >
                    {item.label}
                  </text>
                </g>
              );
            })}
          </svg>
          
          {/* Legend */}
          <div style={{ marginTop: '8px', display: 'flex', gap: '12px', fontSize: '9px' }}>
            <div style={{ display: 'flex', alignItems: 'center', gap: '3px' }}>
              <div style={{ width: 10, height: 10, backgroundColor: TEAL, borderRadius: 2 }}></div>
              <span>Revenue</span>
            </div>
            <div style={{ display: 'flex', alignItems: 'center', gap: '3px' }}>
              <div style={{ width: 10, height: 10, backgroundColor: '#4CAF50', borderRadius: 2 }}></div>
              <span>Profit</span>
            </div>
            <div style={{ display: 'flex', alignItems: 'center', gap: '3px' }}>
              <div style={{ width: 10, height: 10, backgroundColor: '#E57373', borderRadius: 2 }}></div>
              <span>Expense</span>
            </div>
          </div>
        </div>
      );
    };

    // ============================================================================
    // OPEX TREEMAP - Restored from v6 with nested subcategories
    // Percentages shown as % of Net Revenue ($57.8M)
    // ============================================================================
    const OpExTreemap = () => {
      const netRevenue = 57795; // $000s - NWDY actual
      const categories = [
        { 
          name: 'Sales & Marketing', 
          color: '#E57373',
          total: 12570,
          pctRev: 21.7,  // 12570/57795
          items: [
            { label: 'Advertising', value: 6262, pctRev: 10.8 },
            { label: 'Brand/Content', value: 3500, pctRev: 6.1 },
            { label: 'Other Mkt', value: 2808, pctRev: 4.9 },
          ]
        },
        { 
          name: 'Operations', 
          color: '#81C784',
          total: 6927,
          pctRev: 12.0,  // 6927/57795
          items: [
            { label: 'Fulfillment', value: 3200, pctRev: 5.5 },
            { label: 'Logistics', value: 2100, pctRev: 3.6 },
            { label: 'Technology', value: 1027, pctRev: 1.8 },
            { label: 'Other', value: 600, pctRev: 1.0 },
          ]
        },
        { 
          name: 'G&A', 
          color: '#64B5F6',
          total: 15562,
          pctRev: 26.9,  // 15562/57795
          items: [
            { label: 'Payroll/HR', value: 10038, pctRev: 17.4 },
            { label: 'Prof. Svc', value: 2500, pctRev: 4.3 },
            { label: 'Insurance', value: 1800, pctRev: 3.1 },
            { label: 'Other', value: 1224, pctRev: 2.1 },
          ]
        },
      ];
      
      const grandTotal = 35059;
      const height = 140;

      return (
        <div>
          <div style={{ display: 'flex', height, gap: '3px' }}>
            {categories.map((cat, catIdx) => {
              const catWidthPct = (cat.total / grandTotal) * 100;
              
              return (
                <div 
                  key={catIdx} 
                  style={{ 
                    width: `${catWidthPct}%`, 
                    display: 'flex', 
                    flexDirection: 'column',
                    gap: '2px'
                  }}
                >
                  {/* Category header - now shows % of revenue */}
                  <div style={{ 
                    fontSize: '11px', 
                    fontWeight: '600', 
                    color: '#333',
                    marginBottom: '2px'
                  }}>
                    {cat.name} <span style={{ color: '#666', fontWeight: '500' }}>${(cat.total/1000).toFixed(1)}M ({cat.pctRev}% of rev)</span>
                  </div>
                  
                  {/* Items container - different layouts based on category */}
                  {catIdx === 0 ? (
                    // S&M: One big block (Advertising) with small blocks below
                    <div style={{ flex: 1, display: 'flex', flexDirection: 'column', gap: '2px' }}>
                      <div 
                        style={{ 
                          flex: 1, 
                          backgroundColor: cat.color, 
                          borderRadius: '4px',
                          display: 'flex',
                          alignItems: 'center',
                          justifyContent: 'center',
                          flexDirection: 'column',
                          minHeight: '80px'
                        }}
                      >
                        <span style={{ color: 'white', fontSize: '12px', fontWeight: '600' }}>Advertising</span>
                        <span style={{ color: 'white', fontSize: '11px', opacity: 0.9 }}>${(6262/1000).toFixed(1)}M (10.8% of rev)</span>
                      </div>
                      <div style={{ display: 'flex', gap: '2px', height: '28px' }}>
                        <div style={{ flex: 1, backgroundColor: cat.color, opacity: 0.7, borderRadius: '3px', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                          <span style={{ color: 'white', fontSize: '9px' }}>Brand $3.5M</span>
                        </div>
                        <div style={{ flex: 1, backgroundColor: cat.color, opacity: 0.5, borderRadius: '3px', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                          <span style={{ color: 'white', fontSize: '9px' }}>Other $2.8M</span>
                        </div>
                      </div>
                    </div>
                  ) : catIdx === 1 ? (
                    // Operations: 2x2 grid layout
                    <div style={{ flex: 1, display: 'flex', flexDirection: 'column', gap: '2px' }}>
                      <div style={{ display: 'flex', gap: '2px', flex: 1 }}>
                        <div style={{ flex: 1, backgroundColor: cat.color, borderRadius: '4px', display: 'flex', alignItems: 'center', justifyContent: 'center', flexDirection: 'column', padding: '4px' }}>
                          <span style={{ color: 'white', fontSize: '10px', fontWeight: '600' }}>Fulfillment</span>
                          <span style={{ color: 'white', fontSize: '9px', opacity: 0.9 }}>$3.2M (5.5%)</span>
                        </div>
                        <div style={{ flex: 0.85, backgroundColor: cat.color, opacity: 0.85, borderRadius: '4px', display: 'flex', alignItems: 'center', justifyContent: 'center', flexDirection: 'column', padding: '4px' }}>
                          <span style={{ color: 'white', fontSize: '10px', fontWeight: '600' }}>Logistics</span>
                          <span style={{ color: 'white', fontSize: '9px', opacity: 0.9 }}>$2.1M (3.6%)</span>
                        </div>
                      </div>
                      <div style={{ display: 'flex', gap: '2px', flex: 0.7 }}>
                        <div style={{ flex: 1, backgroundColor: cat.color, opacity: 0.7, borderRadius: '3px', display: 'flex', alignItems: 'center', justifyContent: 'center', flexDirection: 'column' }}>
                          <span style={{ color: 'white', fontSize: '9px', fontWeight: '500' }}>Tech $1.0M (1.8%)</span>
                        </div>
                        <div style={{ flex: 0.6, backgroundColor: cat.color, opacity: 0.55, borderRadius: '3px', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                          <span style={{ color: 'white', fontSize: '8px' }}>Other $0.6M</span>
                        </div>
                      </div>
                    </div>
                  ) : (
                    // G&A: 2x2 grid
                    <div style={{ flex: 1, display: 'flex', flexDirection: 'column', gap: '2px' }}>
                      <div style={{ display: 'flex', gap: '2px', flex: 1 }}>
                        <div style={{ flex: 1, backgroundColor: cat.color, borderRadius: '4px', display: 'flex', alignItems: 'center', justifyContent: 'center', flexDirection: 'column' }}>
                          <span style={{ color: 'white', fontSize: '9px', fontWeight: '600' }}>Payroll/HR</span>
                          <span style={{ color: 'white', fontSize: '8px', opacity: 0.9 }}>$10.0M (17.4%)</span>
                        </div>
                        <div style={{ flex: 0.7, backgroundColor: cat.color, opacity: 0.8, borderRadius: '4px', display: 'flex', alignItems: 'center', justifyContent: 'center', flexDirection: 'column' }}>
                          <span style={{ color: 'white', fontSize: '9px', fontWeight: '600' }}>Prof. Svc</span>
                          <span style={{ color: 'white', fontSize: '8px', opacity: 0.9 }}>$2.5M</span>
                        </div>
                      </div>
                      <div style={{ display: 'flex', gap: '2px', flex: 0.7 }}>
                        <div style={{ flex: 1, backgroundColor: cat.color, opacity: 0.65, borderRadius: '3px', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                          <span style={{ color: 'white', fontSize: '8px' }}>Insurance $1.8M</span>
                        </div>
                        <div style={{ flex: 0.6, backgroundColor: cat.color, opacity: 0.5, borderRadius: '3px', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                          <span style={{ color: 'white', fontSize: '8px' }}>Other $1.2M</span>
                        </div>
                      </div>
                    </div>
                  )}
                </div>
              );
            })}
          </div>
          
          {/* Legend with $ and % of revenue */}
          <div style={{ display: 'flex', gap: '20px', marginTop: '12px', justifyContent: 'center' }}>
            {categories.map((cat, i) => (
              <div key={i} style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
                <div style={{ width: 14, height: 14, backgroundColor: cat.color, borderRadius: 3 }}></div>
                <span style={{ fontSize: '11px', color: '#555' }}>
                  {cat.name}: <strong>${(cat.total/1000).toFixed(1)}M</strong> ({cat.pctRev}% of rev)
                </span>
              </div>
            ))}
          </div>
        </div>
      );
    };

    // OpEx Treemap by Priority (Payroll, CAC, Other)
    const OpExTreemapByPriority = () => {
      const categories = [
        { 
          name: 'Customer Acquisition', 
          color: '#7C3AED', // Purple
          total: 6262,
          pctRev: 10.8,
          items: [
            { label: 'Paid Media', value: 6262, pctRev: 10.8 },
          ]
        },
        { 
          name: 'Other OpEx', 
          color: '#F59E0B', // Amber
          total: 18759,
          pctRev: 32.5,
          items: [
            { label: 'Fulfillment', value: 5500, pctRev: 9.5 },
            { label: 'Prof. Svc', value: 4200, pctRev: 7.3 },
            { label: 'Technology', value: 3500, pctRev: 6.1 },
            { label: 'Insurance', value: 2800, pctRev: 4.8 },
            { label: 'Other', value: 2759, pctRev: 4.8 },
          ]
        },
        { 
          name: 'Payroll', 
          color: '#0EA5E9', // Sky blue
          total: 10038,
          pctRev: 17.4,
          items: [
            { label: 'Salaries', value: 8500, pctRev: 14.7 },
            { label: 'Benefits', value: 1538, pctRev: 2.7 },
          ]
        },
      ];
      
      const grandTotal = 35059;
      const height = 120;

      return (
        <div>
          <div style={{ display: 'flex', height, gap: '3px' }}>
            {categories.map((cat, catIdx) => {
              const catWidthPct = (cat.total / grandTotal) * 100;
              
              return (
                <div 
                  key={catIdx} 
                  style={{ 
                    width: `${catWidthPct}%`, 
                    display: 'flex', 
                    flexDirection: 'column',
                    gap: '2px'
                  }}
                >
                  <div style={{ 
                    fontSize: '11px', 
                    fontWeight: '600', 
                    color: '#333',
                    marginBottom: '2px'
                  }}>
                    {cat.name} <span style={{ color: '#666', fontWeight: '500' }}>${(cat.total/1000).toFixed(1)}M ({cat.pctRev}% of rev)</span>
                  </div>
                  
                  {catIdx === 0 ? (
                    // CAC: One big block with small below
                    <div style={{ flex: 1, display: 'flex', flexDirection: 'column', gap: '2px' }}>
                      <div style={{ 
                        flex: 1, 
                        backgroundColor: cat.color, 
                        borderRadius: '4px',
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'center',
                        flexDirection: 'column',
                        minHeight: '70px'
                      }}>
                        <span style={{ color: 'white', fontSize: '12px', fontWeight: '600' }}>Paid Media</span>
                        <span style={{ color: 'white', fontSize: '11px', opacity: 0.9 }}>$6.3M (10.8% of rev)</span>
                      </div>
                      <div style={{ height: '24px', backgroundColor: cat.color, opacity: 0.6, borderRadius: '3px', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                        <span style={{ color: 'white', fontSize: '9px' }}>Other CAC $201K</span>
                      </div>
                    </div>
                  ) : catIdx === 1 ? (
                    // Other OpEx: Grid layout
                    <div style={{ flex: 1, display: 'flex', flexDirection: 'column', gap: '2px' }}>
                      <div style={{ display: 'flex', gap: '2px', flex: 1 }}>
                        <div style={{ flex: 1, backgroundColor: cat.color, borderRadius: '4px', display: 'flex', alignItems: 'center', justifyContent: 'center', flexDirection: 'column' }}>
                          <span style={{ color: 'white', fontSize: '10px', fontWeight: '600' }}>Fulfillment</span>
                          <span style={{ color: 'white', fontSize: '9px', opacity: 0.9 }}>$890K (6.6%)</span>
                        </div>
                        <div style={{ flex: 0.9, backgroundColor: cat.color, opacity: 0.85, borderRadius: '4px', display: 'flex', alignItems: 'center', justifyContent: 'center', flexDirection: 'column' }}>
                          <span style={{ color: 'white', fontSize: '10px', fontWeight: '600' }}>Prof. Svc</span>
                          <span style={{ color: 'white', fontSize: '9px', opacity: 0.9 }}>$432K (3.2%)</span>
                        </div>
                      </div>
                      <div style={{ display: 'flex', gap: '2px', height: '28px' }}>
                        <div style={{ flex: 1, backgroundColor: cat.color, opacity: 0.7, borderRadius: '3px', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                          <span style={{ color: 'white', fontSize: '8px' }}>Tech $390K</span>
                        </div>
                        <div style={{ flex: 0.5, backgroundColor: cat.color, opacity: 0.55, borderRadius: '3px', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                          <span style={{ color: 'white', fontSize: '8px' }}>Ins $145K</span>
                        </div>
                        <div style={{ flex: 0.4, backgroundColor: cat.color, opacity: 0.4, borderRadius: '3px', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                          <span style={{ color: 'white', fontSize: '8px' }}>$139K</span>
                        </div>
                      </div>
                    </div>
                  ) : (
                    // Payroll: Simple 2-row
                    <div style={{ flex: 1, display: 'flex', flexDirection: 'column', gap: '2px' }}>
                      <div style={{ flex: 1, backgroundColor: cat.color, borderRadius: '4px', display: 'flex', alignItems: 'center', justifyContent: 'center', flexDirection: 'column' }}>
                        <span style={{ color: 'white', fontSize: '10px', fontWeight: '600' }}>Salaries</span>
                        <span style={{ color: 'white', fontSize: '9px', opacity: 0.9 }}>$420K (3.1%)</span>
                      </div>
                      <div style={{ height: '24px', backgroundColor: cat.color, opacity: 0.7, borderRadius: '3px', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                        <span style={{ color: 'white', fontSize: '9px' }}>Benefits $98K</span>
                      </div>
                    </div>
                  )}
                </div>
              );
            })}
          </div>
          
          {/* Legend */}
          <div style={{ display: 'flex', gap: '20px', marginTop: '12px', justifyContent: 'center' }}>
            {categories.map((cat, i) => (
              <div key={i} style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
                <div style={{ width: 14, height: 14, backgroundColor: cat.color, borderRadius: 3 }}></div>
                <span style={{ fontSize: '11px', color: '#555' }}>
                  {cat.name}: <strong>${(cat.total/1000).toFixed(1)}M</strong> ({cat.pctRev}% of rev)
                </span>
              </div>
            ))}
          </div>
        </div>
      );
    };

    // ============================================================================
    // TREND CHARTS
    // ============================================================================
    
    // Single-line trend chart with aligned cohort label
    const TrendChart = ({ title, data, cohortValue, unit = '%', cohortLabel = 'Cohort' }) => {
      const actualMax = Math.max(...data, cohortValue);
      const actualMin = Math.min(...data, 0);
      const maxVal = actualMax * 1.15;
      const minVal = Math.min(actualMin, 0);
      const range = maxVal - minVal;
      
      const chartW = 260;
      const chartH = 70;
      
      const getX = (i) => (i / (data.length - 1)) * chartW;
      const getY = (val) => chartH - ((val - minVal) / range) * chartH;
      
      const points = data.map((d, i) => `${getX(i)},${getY(d)}`).join(' ');
      const cohortY = getY(cohortValue);

      return (
        <div style={{ marginBottom: '16px' }}>
          <div style={{ fontSize: '11px', fontWeight: '600', color: '#333', marginBottom: '8px' }}>{title}</div>
          <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
            <div style={{ display: 'flex', flexDirection: 'column', justifyContent: 'space-between', height: chartH, fontSize: '9px', color: '#999', minWidth: '32px', textAlign: 'right' }}>
              <span>{maxVal.toFixed(unit === 'x' ? 1 : 0)}{unit}</span>
              <span>{minVal.toFixed(unit === 'x' ? 1 : 0)}{unit}</span>
            </div>
            <div style={{ flex: 1, position: 'relative' }}>
              <svg viewBox={`0 0 ${chartW} ${chartH + 16}`} style={{ width: '100%', overflow: 'visible' }}>
                <line x1="0" y1={chartH} x2={chartW} y2={chartH} stroke="#ddd" />
                <polyline points={points} fill="none" stroke={TEAL} strokeWidth="2.5" />
                {data.map((d, i) => (
                  <g key={i}>
                    <circle cx={getX(i)} cy={getY(d)} r="3" fill={TEAL} />
                    <text x={getX(i)} y={chartH + 12} fontSize="8" fill="#666" textAnchor="middle">{MONTHLY.months[i]}</text>
                  </g>
                ))}
                <circle cx={chartW} cy={cohortY} r="5" fill={GOLD} />
              </svg>
            </div>
            <div style={{ 
              fontSize: '9px', 
              color: GOLD, 
              fontWeight: '600', 
              minWidth: '50px',
              position: 'relative',
              height: chartH
            }}>
              <span style={{ 
                position: 'absolute', 
                top: `${cohortY}px`,
                transform: 'translateY(-50%)'
              }}>
                {cohortLabel}
              </span>
            </div>
          </div>
        </div>
      );
    };

    // Multi-line trend chart with color-matched cohort dots (Item 22 fix)
    // v8.3: Lighter middle gray, legend next to title
    const MultiTrendChart = ({ title, lines, cohorts, unit = '%', showBreakeven = false }) => {
      const allValues = lines.flatMap(l => l.data).concat(cohorts.map(c => c.value));
      const maxVal = Math.max(...allValues) * 1.15;
      const minVal = showBreakeven ? 0 : Math.min(...allValues, 0);
      const range = maxVal - minVal;
      
      const chartW = 260;
      const chartH = 70;
      // Blue, light gray, dark gray - middle line now lighter for distinction
      const colors = ['#2563EB', '#9CA3AF', '#374151'];
      
      const getX = (i) => (i / 5) * chartW;
      const getY = (val) => chartH - ((val - minVal) / range) * chartH;

      return (
        <div style={{ marginBottom: '16px' }}>
          {/* Title with inline legend */}
          <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '8px' }}>
            <div style={{ fontSize: '11px', fontWeight: '600', color: '#333' }}>{title}</div>
            <div style={{ display: 'flex', gap: '12px', fontSize: '10px' }}>
              {lines.map((line, li) => (
                <div key={li} style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>
                  <div style={{ width: 12, height: 3, backgroundColor: colors[li], borderRadius: 1 }}></div>
                  <span style={{ color: colors[li], fontWeight: '500' }}>{line.label}</span>
                </div>
              ))}
            </div>
          </div>
          <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
            <div style={{ display: 'flex', flexDirection: 'column', justifyContent: 'space-between', height: chartH, fontSize: '9px', color: '#999', minWidth: '32px', textAlign: 'right' }}>
              <span>{maxVal.toFixed(unit === 'x' ? 1 : 0)}{unit}</span>
              <span>{minVal.toFixed(unit === 'x' ? 1 : 0)}{unit}</span>
            </div>
            <div style={{ flex: 1 }}>
              <svg viewBox={`0 0 ${chartW} ${chartH + 16}`} style={{ width: '100%', overflow: 'visible' }}>
                <line x1="0" y1={chartH} x2={chartW} y2={chartH} stroke="#ddd" />
                
                {showBreakeven && (
                  <line x1="0" y1={getY(1)} x2={chartW} y2={getY(1)} stroke={RED} strokeWidth="1" strokeDasharray="4" />
                )}
                
                {lines.map((line, li) => (
                  <g key={li}>
                    <polyline 
                      points={line.data.map((d, i) => `${getX(i)},${getY(d)}`).join(' ')} 
                      fill="none" 
                      stroke={colors[li]} 
                      strokeWidth="2"
                    />
                    {line.data.map((d, i) => (
                      <circle key={i} cx={getX(i)} cy={getY(d)} r="2.5" fill={colors[li]} />
                    ))}
                  </g>
                ))}
                
                {/* Cohort dots - color matched to their lines (Item 22) */}
                {cohorts.map((c, ci) => (
                  <circle key={ci} cx={chartW + 5} cy={getY(c.value)} r="4" fill={colors[ci]} />
                ))}
                
                {MONTHLY.months.map((m, i) => (
                  <text key={i} x={getX(i)} y={chartH + 12} fontSize="8" fill="#666" textAnchor="middle">{m}</text>
                ))}
              </svg>
            </div>
            {/* Cohort label aligned to dots */}
            <div style={{ minWidth: '45px', fontSize: '9px', color: '#666', fontWeight: '500' }}>
              Cohort
            </div>
          </div>
        </div>
      );
    };

    // MER Chart with formulas and pMER emphasis
    const MERChart = () => {
      const lines = [
        { label: 'MER', data: MONTHLY.MER, formula: 'Rev · All Mkt' },
        { label: 'gMER', data: MONTHLY.gMER, formula: 'Rev · Paid Media' },
        { label: 'pMER', data: MONTHLY.pMER, formula: 'GP · All Mkt' },
      ];
      
      const allValues = lines.flatMap(l => l.data);
      const maxVal = Math.max(...allValues) * 1.15;
      const minVal = 0;
      const range = maxVal - minVal;
      
      const chartW = 260;
      const chartH = 80;
      const colors = ['#2563EB', '#6B7280', GREEN];
      
      const getX = (i) => (i / 5) * chartW;
      const getY = (val) => chartH - ((val - minVal) / range) * chartH;

      return (
        <div>
          <div style={{ fontSize: '11px', fontWeight: '600', color: '#333', marginBottom: '8px' }}>Marketing Efficiency Trend</div>
          <div style={{ display: 'flex', alignItems: 'flex-start', gap: '8px' }}>
            <div style={{ display: 'flex', flexDirection: 'column', justifyContent: 'space-between', height: chartH, fontSize: '9px', color: '#999', minWidth: '28px', textAlign: 'right' }}>
              <span>{maxVal.toFixed(1)}x</span>
              <span>0x</span>
            </div>
            <div style={{ flex: 1 }}>
              <svg viewBox={`0 0 ${chartW} ${chartH + 16}`} style={{ width: '100%', overflow: 'visible' }}>
                <line x1="0" y1={chartH} x2={chartW} y2={chartH} stroke="#ddd" />
                
                {/* Breakeven line */}
                <line x1="0" y1={getY(1)} x2={chartW} y2={getY(1)} stroke={RED} strokeWidth="1" strokeDasharray="4" />
                <text x="3" y={getY(1) - 3} fontSize="8" fill={RED}>Breakeven</text>
                
                {lines.map((line, li) => (
                  <g key={li}>
                    <polyline 
                      points={line.data.map((d, i) => `${getX(i)},${getY(d)}`).join(' ')} 
                      fill="none" 
                      stroke={colors[li]} 
                      strokeWidth={li === 2 ? 3 : 2}
                    />
                    {line.data.map((d, i) => (
                      <circle key={i} cx={getX(i)} cy={getY(d)} r={li === 2 ? 3.5 : 2.5} fill={colors[li]} />
                    ))}
                  </g>
                ))}
                
                {MONTHLY.months.map((m, i) => (
                  <text key={i} x={getX(i)} y={chartH + 12} fontSize="8" fill="#666" textAnchor="middle">{m}</text>
                ))}
              </svg>
            </div>
            {/* Legend with formulas */}
            <div style={{ minWidth: '95px', fontSize: '9px' }}>
              {lines.map((line, li) => (
                <div key={li} style={{ color: colors[li], marginBottom: '4px', display: 'flex', alignItems: 'center', gap: '4px' }}>
                  <div style={{ width: 10, height: li === 2 ? 3 : 2, backgroundColor: colors[li] }}></div>
                  <span style={{ fontWeight: li === 2 ? '600' : '400' }}>{line.label}</span>
                  <span style={{ fontSize: '8px', opacity: 0.7 }}>({line.formula})</span>
                </div>
              ))}
            </div>
          </div>
        </div>
      );
    };

    // ============================================================================
    // PAGES
    // ============================================================================

    // Page 1: Overview
    const OverviewPage = () => (
      <div className="print-page" style={{ padding: '20px 28px' }}>
        <Card>
          {/* Cohort extraordinariness callout (Item 1) */}
          <div style={{ 
            backgroundColor: LIGHT_AMBER, 
            border: `1px solid ${GOLD}`,
            borderRadius: '6px',
            padding: '12px 16px',
            marginBottom: '20px',
            fontSize: '12px',
            color: '#666'
          }}>
            <strong style={{ color: GOLD }}>Cohort Context:</strong> This analysis compares NWDY against an <strong>extraordinary cohort</strong> — top-decile performers at the $60M milestone. 
            Matching cohort averages indicates strong execution; exceeding them indicates exceptional performance.
          </div>

          <SectionHeader>Executive Summary</SectionHeader>
          
          <p style={{ fontSize: '13px', lineHeight: '1.7', color: '#444', marginBottom: '20px' }}>
            NWDY demonstrates <strong style={{ color: GREEN }}>exceptional underlying performance</strong> with multiple metrics 
            exceeding the extraordinary cohort's maximum thresholds. The company reached the $60M milestone in just 
            <strong style={{ color: TEAL }}> 32 months from first revenue</strong> — well under the cohort average of 44 months — while achieving 
            profitability that most peers at this stage cannot match.
          </p>

          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px', marginBottom: '20px' }}>
            <CalloutBox type="strength" title="Exceptional Outperformance">
              <ul style={{ margin: 0, paddingLeft: '18px' }}>
                <li>EBITDA +9.1 pts above cohort (5.6% vs -53.5%)</li>
                <li>Net Income +5.2 pts above cohort (10.5% vs 5.3%)</li>
                <li>G&A 21 pts leaner than cohort</li>
                <li>Cash generative while growing (negative growth efficiency)</li>
                <li>pMER of 3.09x (cohort ~0.85x)</li>
                <li>Reached milestone in 32 months from first revenue (vs 44 cohort avg)</li>
              </ul>
            </CalloutBox>

            <CalloutBox type="warning" title="Areas to Monitor">
              <ul style={{ margin: 0, paddingLeft: '18px' }}>
                <li>Organizational maturity at 32 months from first revenue</li>
                <li>G&A may be too lean to manage risks at this scale</li>
                <li>Supply chain depth and vendor diversification</li>
                <li>Leadership team scaled for $30M+ complexity</li>
                <li>pMER volatility month-to-month</li>
                <li>Ops costs as % of revenue (DTC structural)</li>
                <li>When/whether to deploy remaining capital</li>
              </ul>
            </CalloutBox>
          </div>

          {/* Discussion Prompts - Bulleted (Item 5) */}
          <div style={{ marginBottom: '16px' }}>
            <CalloutBox type="strategic" title="Strategic Discussion Prompts">
              <ul style={{ margin: 0, paddingLeft: '18px' }}>
                <li><strong>Growth Investment:</strong> Would NWDY benefit from a modest increase in S&M to accelerate growth while maintaining efficiency — or is the current capital-light approach optimal?</li>
                <li><strong>pMER Optimization:</strong> What's driving pMER volatility (1.4x–4.3x)? Can high-pMER months be replicated?</li>
                <li><strong>Channel Strategy:</strong> Wholesale distribution offers significant growth opportunity, but requires substantially more working capital (inventory, longer payment cycles). Current profitability may not generate sufficient cash to fund channel expansion without additional capital.</li>
                <li><strong>Capital Deployment:</strong> With $3M+ in undeployed capital and positive cash flow, what's the right deployment strategy?</li>
              </ul>
            </CalloutBox>
          </div>
          
          {/* Propeller Advisory Note - Yellow with exclamation icon and bullets (v8.3 fix) */}
          <div style={{ 
            padding: '14px 16px',
            backgroundColor: LIGHT_AMBER,
            border: `1px solid ${GOLD}`,
            borderRadius: '6px'
          }}>
            <div style={{ fontSize: '12px', fontWeight: '600', color: GOLD, marginBottom: '10px', display: 'flex', alignItems: 'center', gap: '6px' }}>
              <span>*</span> Propeller Advisory Note
            </div>
            <p style={{ fontSize: '11px', lineHeight: '1.6', color: '#555', margin: '0 0 10px 0' }}>
              As financial advisors, we note that companies at this velocity often defer investments in compliance infrastructure, transaction readiness, and data integrity. These gaps are invisible until they become urgent — typically during a fundraise, audit, or acquisition process.
            </p>
            <p style={{ fontSize: '11px', lineHeight: '1.6', color: '#555', margin: '0 0 8px 0' }}>
              NWDY's G&A at 26.9% (vs 24.8% cohort) warrants a candid assessment of what's been deferred in:
            </p>
            <ul style={{ margin: 0, paddingLeft: '20px', fontSize: '11px', lineHeight: '1.7', color: '#555' }}>
              <li><strong>Compliance:</strong> Legal, regulatory, tax infrastructure</li>
              <li><strong>Transaction readiness:</strong> Audit prep, data room quality, financial reporting rigor</li>
              <li><strong>Data integrity:</strong> Systems, controls, reconciliation processes</li>
              <li><strong>Key person risk:</strong> With payroll at 1/4 of cohort, likely heavy founder dependency</li>
            </ul>
          </div>
        </Card>
      </div>
    );

    // Page 2: P&L Variance
    const PLVariancePage = () => (
      <div className="print-page" style={{ padding: '20px 28px' }}>
        <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '20px' }}>
          {/* Revenue vs Cohort */}
          <Card>
            <SectionHeader>Revenue vs Cohort</SectionHeader>
            <VarianceBar label="Gross Revenue" companyPct={COMPANY.grossRevenuePct} cohortPct={COHORT.grossRevenuePct} />
            <VarianceBar label="Discounts & Returns" companyPct={COMPANY.discountsPct} cohortPct={COHORT.discountsPct} lowerIsBetter />
            <VarianceBar label="Trade Deductions" companyPct={COMPANY.tradeDeductionsPct} cohortPct={COHORT.tradeDeductionsPct} lowerIsBetter />
            <InsightBox lead="Net Revenue">
              $57.8M vs $62.4M cohort — lower discounting (2.4% vs 5.2%) preserves margin.
            </InsightBox>
          </Card>

          {/* Earnings vs Cohort */}
          <Card>
            <SectionHeader>Earnings vs Cohort</SectionHeader>
            <VarianceBar label="EBITDA Margin" companyPct={COMPANY.ebitdaPct} cohortPct={COHORT.ebitdaPct} badge="above max" />
            <VarianceBar label="Other Expenses" companyPct={1.2} cohortPct={COHORT.otherExpensesPct} lowerIsBetter />
            <VarianceBar label="Net Income Margin" companyPct={COMPANY.netIncomePct} cohortPct={COHORT.netIncomePct} badge="above max" />
            <InsightBox lead="+5.2 pts Net Income advantage">
              driven by exceptional EBITDA performance — both metrics above cohort maximum.
            </InsightBox>
          </Card>

          {/* OpEx by Function (Item 16) */}
          <Card>
            <SectionHeader>OpEx by Function</SectionHeader>
            <VarianceBar label="G&A" companyPct={COMPANY.gaPct} cohortPct={COHORT.gaPct} lowerIsBetter badge="above max" />
            <VarianceBar label="Sales & Marketing" companyPct={COMPANY.smPct} cohortPct={COHORT.smPct} lowerIsBetter />
            <VarianceBar label="Operations" companyPct={COMPANY.operationsPct} cohortPct={COHORT.operationsPct} lowerIsBetter />
            <InsightBox lead="DTC Model">
              Higher S&M and fulfillment offset by extremely lean G&A. See Areas to Monitor for risk framing.
            </InsightBox>
          </Card>

          {/* OpEx by Priority (Item 16) */}
          <Card>
            <SectionHeader>OpEx by Priority</SectionHeader>
            <VarianceBar label="Payroll" companyPct={COMPANY.payrollPct} cohortPct={COHORT.payrollPct} lowerIsBetter />
            <VarianceBar label="Customer Acquisition" companyPct={COMPANY.cacPct} cohortPct={COHORT.cacPct} lowerIsBetter />
            <VarianceBar label="Other OpEx" companyPct={COMPANY.otherOpexPct} cohortPct={COHORT.otherOpexPct} lowerIsBetter />
            <InsightBox lead="Staffing at Parity">
              Payroll (17.4% vs 17.5% cohort) indicates appropriate staffing levels for this growth stage.
            </InsightBox>
          </Card>
        </div>
      </div>
    );

    // Page 3: Analytics - Restored layout from v6
    const AnalyticsPage = () => (
      <div className="print-page" style={{ padding: '20px 28px' }}>
        <div style={{ display: 'flex', gap: '16px', marginBottom: '16px' }}>
          <Card style={{ flex: 1.1 }}>
            <SectionHeader>P&L Flow</SectionHeader>
            <SankeyChart />
          </Card>
          <Card style={{ flex: 0.9 }}>
            <SectionHeader>P&L Waterfall ($000s)</SectionHeader>
            <WaterfallChart />
          </Card>
        </div>
        
        <Card>
          <SectionHeader>Operating Expenses by Function ($35.1M Annualized)</SectionHeader>
          <OpExTreemap />
        </Card>
        
        <Card style={{ marginTop: '20px' }}>
          <SectionHeader>Operating Expenses by Priority ($35.1M Annualized)</SectionHeader>
          <OpExTreemapByPriority />
        </Card>
      </div>
    );

    // Page 4: Efficiency - Vertical layout (v8.3 fix)
    const EfficiencyPage = () => (
      <div className="print-page" style={{ padding: '20px 28px' }}>
        {/* Marketing Efficiency - Full width */}
        <Card style={{ marginBottom: '20px' }}>
          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '24px' }}>
            {/* Left: Variance Bars */}
            <div>
              <SectionHeader>Marketing Efficiency</SectionHeader>
              
              {/* MER Variance Bars */}
              <MERVarianceBar label="gMER" companyVal={COMPANY.gMER} cohortVal={COHORT.gMER} formula="Rev · Paid Media" />
              <MERVarianceBar label="MER" companyVal={COMPANY.MER} cohortVal={COHORT.MER} formula="Rev · All Mkt" />
              <MERVarianceBar label="pMER" companyVal={COMPANY.pMER} cohortVal={COHORT.pMER} formula="GP · All Mkt" />
              
              {/* pMER callout */}
              <div style={{ 
                backgroundColor: LIGHT_GREEN, 
                padding: '10px 12px', 
                borderRadius: '6px',
                marginTop: '12px'
              }}>
                <div style={{ fontSize: '10px', color: GREEN, fontWeight: '600', marginBottom: '4px' }}>pMER &gt; 1.0 = Profitable marketing</div>
                <div style={{ fontSize: '11px', color: '#555' }}>
                  NWDY: $3.09 gross profit per $1 spent | Cohort: $0.85 (below breakeven)
                </div>
              </div>
            </div>
            
            {/* Right: pMER Explanation */}
            <div>
              <div style={{ fontSize: '14px', fontWeight: '700', color: TEAL, marginBottom: '12px' }}>
                pMER: Profit-Adjusted Marketing Efficiency
              </div>
              <p style={{ fontSize: '12px', lineHeight: '1.6', color: '#444', marginBottom: '12px' }}>
                Raw MER ignores margin structure. <strong style={{ color: TEAL }}>pMER answers the real question:</strong> how much gross profit do you generate per marketing dollar?
              </p>
              <div style={{ 
                backgroundColor: '#f8f9fa', 
                padding: '12px', 
                borderRadius: '6px',
                marginBottom: '12px',
                fontFamily: 'monospace'
              }}>
                <div style={{ fontSize: '12px', color: '#333', marginBottom: '4px' }}>pMER = MER - Gross Margin</div>
                <div style={{ fontSize: '12px', color: TEAL }}>NWDY: 4.67 - 66% = <strong>3.09</strong></div>
              </div>
              <p style={{ fontSize: '12px', lineHeight: '1.6', color: '#444', marginBottom: '12px' }}>
                NWDY's raw MER (4.67x) looks only marginally better than cohort (2.5x). But pMER reveals the company is <strong style={{ color: GREEN }}>2x more efficient</strong> at converting marketing spend into gross profit.
              </p>
              <div style={{ 
                backgroundColor: LIGHT_AMBER, 
                padding: '10px 12px', 
                borderRadius: '6px',
                border: `1px solid ${GOLD}`
              }}>
                <div style={{ fontSize: '11px', color: '#555' }}>
                  <strong style={{ color: GOLD }}>Breakeven:</strong> At 66% GM, NWDY breaks even at MER of 1.5x. At 35% GM, cohort needs MER of 2.9x just to break even.
                </div>
              </div>
            </div>
          </div>
        </Card>

        {/* Capital Efficiency - Full width */}
        <Card>
          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '24px' }}>
            {/* Left: Variance Bars */}
            <div>
              <SectionHeader>Capital Efficiency</SectionHeader>
              <CapitalVarianceBar label="Capital Raised ($M)" companyVal={4.6} cohortVal={3.9} unit="M" />
              <CapitalVarianceBar label="Capital Deployed ($M)" companyVal={1.6} cohortVal={3.1} unit="M" lowerIsBetter />
              <CapitalVarianceBar label="Capital Efficiency" companyVal={COMPANY.capitalEfficiency} cohortVal={COHORT.capitalEfficiency} unit="x" />
              <CapitalVarianceBar label="Growth Efficiency T12M" companyVal={COMPANY.growthEfficiencyT12M} cohortVal={COHORT.growthEfficiencyT12M} unit="" />
              
              <InsightBox lead="Cash Generative">
                Growth efficiency of 10.3 reflects efficient capital deployment for revenue growth — exceptional at this stage.
              </InsightBox>
              
              {/* Formulas */}
              <div style={{ marginTop: '12px', padding: '10px', backgroundColor: '#f5f5f5', borderRadius: '6px', fontSize: '10px', color: '#666' }}>
                <div style={{ fontWeight: '600', marginBottom: '6px', color: '#555' }}>Formulas:</div>
                <div style={{ marginBottom: '3px' }}><strong>Capital Deployed</strong> = Retained Earnings + YTD Net Income (cumulative operating loss/gain)</div>
                <div style={{ marginBottom: '3px' }}><strong>Capital Efficiency</strong> = Run Rate Net Revenue · Capital Deployed</div>
                <div><strong>Growth Efficiency</strong> = Revenue Growth · EBITDA Loss (negative = capital-efficient)</div>
              </div>
            </div>
            
            {/* Right: Capital Story */}
            <div>
              <div style={{ fontSize: '14px', fontWeight: '700', color: TEAL, marginBottom: '12px' }}>
                Capital Story
              </div>
              <p style={{ fontSize: '12px', lineHeight: '1.6', color: '#444', marginBottom: '12px' }}>
                NWDY has raised <strong style={{ color: TEAL }}>$9.1M</strong> in SAFE financing and deployed only 
                <strong style={{ color: TEAL }}> $2.8M</strong> — preserving significant runway.
              </p>
              <p style={{ fontSize: '12px', lineHeight: '1.6', color: '#444', marginBottom: '12px' }}>
                <strong style={{ color: TEAL }}>Speed + Efficiency:</strong> NWDY deployed less capital ($2.8M vs $55.7M) over less time (32 mo vs 44 mo) to reach the same milestone.
              </p>
              <div style={{ 
                backgroundColor: LIGHT_AMBER, 
                padding: '12px', 
                borderRadius: '6px',
                border: `1px solid ${GOLD}`
              }}>
                <div style={{ fontSize: '11px', color: '#555' }}>
                  <strong style={{ color: GOLD }}>Cash Generative:</strong> Growth efficiency of 10.3 reflects efficient capital deployment for revenue growth — exceptional at this stage. With ~$3M+ undeployed, the company has significant optionality.
                </div>
              </div>
            </div>
          </div>
        </Card>
      </div>
    );

    // Page 5: Trends
    const TrendsPage = () => (
      <div className="print-page" style={{ padding: '20px 28px' }}>
        <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '20px' }}>
          {/* Row 1: Top Line */}
          <Card>
            <SectionHeader>Net Revenue Trend</SectionHeader>
            <TrendChart 
              title="Monthly Net Revenue ($K)"
              data={MONTHLY.netRevenue}
              cohortValue={1332}
              unit="K"
              cohortLabel="Cohort"
            />
            <InsightBox lead="Revenue Growth">
              Steady $4.1M-$5.0M monthly range with Jun peak at $5.0M. Trending toward $60M milestone.
            </InsightBox>
          </Card>
          
          <Card>
            <SectionHeader>Gross Profit Trend</SectionHeader>
            <TrendChart 
              title="Monthly Gross Profit ($K)"
              data={MONTHLY.grossProfit}
              cohortValue={904}
              unit="K"
              cohortLabel="Cohort"
            />
            <InsightBox lead="Margin Stability">
              Gross profit follows revenue pattern. Consistent $2.6M-$3.5M monthly GP demonstrates scalable unit economics.
            </InsightBox>
          </Card>

          {/* Row 2: Cost Structure - Multi-line with color-matched dots (Item 22) */}
          <Card>
            <SectionHeader>OpEx by Function Trend</SectionHeader>
            <MultiTrendChart 
              title="Monthly OpEx as % of Revenue"
              lines={[
                { label: 'S&M', data: MONTHLY.smPct },
                { label: 'Ops', data: MONTHLY.opsPct },
                { label: 'G&A', data: MONTHLY.gaPct },
              ]}
              cohorts={[
                { value: COHORT.smPct },
                { value: COHORT.operationsPct },
                { value: COHORT.gaPct },
              ]}
              unit="%"
            />
            <InsightBox lead="Cost Discipline">
              S&M volatile (14-42% of revenue) reflecting campaign timing. G&A steady at 21-33%.
            </InsightBox>
          </Card>
          
          <Card>
            <SectionHeader>OpEx by Priority Trend</SectionHeader>
            <MultiTrendChart 
              title="Monthly Expense Priority (% Rev)"
              lines={[
                { label: 'CAC', data: MONTHLY.cacPct },
                { label: 'Other', data: MONTHLY.otherPct },
                { label: 'Payroll', data: MONTHLY.payrollPct },
              ]}
              cohorts={[
                { value: COHORT.cacPct },
                { value: COHORT.otherOpexPct },
                { value: COHORT.payrollPct },
              ]}
              unit="%"
            />
            <InsightBox lead="Investment Mix">
              Customer acquisition at 7-13% of revenue. Payroll at 14-22% appropriate for scale.
            </InsightBox>
          </Card>

          {/* Row 3: Profitability & Efficiency */}
          <Card>
            <SectionHeader>EBITDA Margin Trend</SectionHeader>
            <TrendChart 
              title="Monthly EBITDA Margin (%)"
              data={MONTHLY.ebitdaMargin}
              cohortValue={COHORT.ebitdaPct}
              unit="%"
              cohortLabel="Cohort"
            />
            <InsightBox lead="Profitability">
              Volatile but trending positive. Sep's 13.7% margin and Jun's 9.4% show consistent profitability.
            </InsightBox>
          </Card>
          
          <Card>
            <SectionHeader>Marketing Efficiency Trend</SectionHeader>
            <MultiTrendChart 
              title="MER / gMER / pMER"
              lines={[
                { label: 'MER', data: MONTHLY.MER },
                { label: 'gMER', data: MONTHLY.gMER },
                { label: 'pMER', data: MONTHLY.pMER },
              ]}
              cohorts={[
                { value: COHORT.MER },
                { value: COHORT.gMER },
                { value: COHORT.pMER },
              ]}
              unit="x"
              showBreakeven={true}
            />
            <InsightBox lead="pMER Above Breakeven">
              pMER consistently &gt;1.0x means profitable customer acquisition. Apr and Sep show 3x+ efficiency.
            </InsightBox>
            <div style={{ fontSize: '10px', color: '#666', marginTop: '8px', fontStyle: 'italic' }}>
              Note: gMER ≈ MER indicates nearly all marketing spend is in paid media — typical for DTC at this stage. As channels diversify (retail, wholesale), these metrics will diverge.
            </div>
          </Card>
        </div>
      </div>
    );

    // Page 6: Narrative
    const NarrativePage = () => (
      <div className="print-page" style={{ padding: '20px 28px' }}>
        <Card>
          <div style={{ fontSize: '13px', lineHeight: '1.7', color: '#333' }}>
            
            <SectionHeader>1. Executive Summary</SectionHeader>
            <p style={{ marginBottom: '16px' }}>
              NWDY demonstrates <strong style={{ color: GREEN }}>exceptional underlying performance</strong>, with several metrics showing 
              significant outperformance relative to the $60M extraordinary cohort. The company has achieved what few DTC brands accomplish 
              at this scale: <strong>profitability while maintaining strong growth</strong>.
            </p>
            <p style={{ marginBottom: '24px' }}>
              With 66% gross margins (vs. 36.5% cohort), 5.6% EBITDA margins (vs. -53.5% cohort), and a pMER of 3.09x, NWDY has built a 
              capital-efficient business model that generates $3.09 of gross profit for every dollar of marketing spend. This positions 
              the company with significant optionality: self-fund continued growth or raise strategically for acceleration.
            </p>

            <SectionHeader>2. Growth Performance</SectionHeader>
            <p style={{ marginBottom: '16px' }}>
              At ~$57.8M annualized revenue, NWDY is tracking toward the $60M milestone with <strong>57.7% YoY growth</strong> — objectively 
              strong performance, though slightly below the cohort's 63.1%.
            </p>
            <p style={{ marginBottom: '24px' }}>
              Critically, NWDY reached this milestone in just <strong style={{ color: TEAL }}>32 months from first revenue</strong> versus the cohort average 
              of 44 months. The "lower" YoY growth reflects a later start date, not slower execution — the company is actually outpacing 
              peers on time-to-milestone.
            </p>

            <SectionHeader>3. Gross Margin Analysis</SectionHeader>
            <p style={{ marginBottom: '16px' }}>
              <strong style={{ color: GREEN }}>Gross margin of 66.3%</strong> is nearly 30 points above the cohort average (36.5%), indicating 
              exceptional product economics and pricing power. This margin profile signals premium positioning, favorable product mix, and efficient 
              supply chain operations. Critically, NWDY maintains these margins with significantly lower discounting than peers (2.4% vs. 5.2% cohort).
            </p>
            <p style={{ marginBottom: '24px' }}>
              <strong>Channel Mix Context:</strong> Current gross margin reflects DTC channel concentration, where NWDY captures full retail margin. 
              As the company expands into wholesale distribution (retail partners, dental professional channel), blended gross margin will likely compress 
              due to retailer margin requirements. However, wholesale channels typically carry significantly lower customer acquisition costs — the contribution 
              margin impact may still be neutral or accretive even with lower GM. This creates strategic optionality: trade gross margin for distribution 
              reach while potentially improving overall unit economics.
            </p>

            <SectionHeader>4. Operating Expenses</SectionHeader>
            <p style={{ marginBottom: '16px' }}>
              Total operating expenses of <strong>$35.1M (60.7% of revenue)</strong> reflect a lean operating model compared to the cohort's 
              90% typical structure.
            </p>
            <div style={{ backgroundColor: LIGHT_TEAL, padding: '12px 16px', borderRadius: '6px', marginBottom: '16px' }}>
              <div style={{ marginBottom: '6px' }}><strong>G&A:</strong> 26.9% of revenue <span style={{ color: '#666' }}>(vs. 24.8% cohort — at parity)</span></div>
              <div style={{ marginBottom: '6px' }}><strong>S&M:</strong> 21.7% of revenue <span style={{ color: GREEN }}>(vs. 43.0% cohort — 21 pts leaner)</span></div>
              <div><strong>Operations:</strong> 12.0% of revenue <span style={{ color: GREEN }}>(vs. 22.1% cohort — 10 pts leaner)</span></div>
            </div>
            <p style={{ marginBottom: '16px' }}>
              The G&A spending is at parity with cohort — NWDY operates with appropriate overhead for this scale. The S&M and Ops efficiency is where the real story emerges.
            </p>
            
            {/* Propeller Advisory Note - echoed from Exec Summary */}
            <div style={{ 
              padding: '14px 16px',
              backgroundColor: LIGHT_AMBER,
              border: `1px solid ${GOLD}`,
              borderRadius: '6px',
              marginBottom: '24px'
            }}>
              <div style={{ fontSize: '12px', fontWeight: '600', color: GOLD, marginBottom: '10px', display: 'flex', alignItems: 'center', gap: '6px' }}>
                <span>* </span> Propeller Advisory Note
              </div>
              <p style={{ fontSize: '12px', lineHeight: '1.6', color: '#555', margin: '0 0 10px 0' }}>
                As financial advisors, we note that companies at this velocity often defer investments in compliance infrastructure, transaction readiness, and data integrity. These gaps are invisible until they become urgent — typically during a fundraise, audit, or acquisition process.
              </p>
              <p style={{ fontSize: '12px', lineHeight: '1.6', color: '#555', margin: '0 0 8px 0' }}>
                NWDY's G&A at 26.9% (vs 24.8% cohort) warrants a candid assessment of what's been deferred in:
              </p>
              <ul style={{ margin: 0, paddingLeft: '20px', fontSize: '12px', lineHeight: '1.7', color: '#555' }}>
                <li><strong>Compliance:</strong> Legal, regulatory, tax infrastructure</li>
                <li><strong>Transaction readiness:</strong> Audit prep, data room quality, financial reporting rigor</li>
                <li><strong>Data integrity:</strong> Systems, controls, reconciliation processes</li>
                <li><strong>Key person risk:</strong> With payroll at 1/4 of cohort, likely heavy founder dependency</li>
              </ul>
            </div>

            <SectionHeader>5. EBITDA & Profitability</SectionHeader>
            <p style={{ marginBottom: '16px' }}>
              <strong style={{ color: GREEN }}>EBITDA of +5.6% (~$1.8M annualized)</strong> significantly outperforms the cohort median of -53.5% and exceeds the cohort maximum. 
              This is a standout result — positive and substantial EBITDA at the $60M scale in consumer/DTC is rare, and achieving it in just 
              <strong style={{ color: TEAL }}> 32 months from first revenue</strong> (vs. 44-month cohort average) makes it exceptional.
            </p>
            <p style={{ marginBottom: '24px' }}>
              <strong style={{ color: GREEN }}>Net Income of +5.7% (~$3.3M annualized)</strong> vs. cohort's 5.3% further demonstrates the 
              quality of earnings. The business is generating real profit, not just adjusted metrics. Most companies at this velocity are still 
              investing heavily in growth infrastructure — NWDY has achieved profitability while others are burning cash.
            </p>

            <SectionHeader>6. Marketing Efficiency (pMER)</SectionHeader>
            <p style={{ marginBottom: '16px' }}>
              <strong>pMER of 3.09x</strong> (Gross Profit · Marketing Spend) is the key efficiency metric. This means NWDY generates 
              $3.09 in gross profit for every $1 invested in marketing — well above the 1.0x breakeven threshold.
            </p>
            <div style={{ backgroundColor: LIGHT_GREEN, padding: '12px 16px', borderRadius: '6px', marginBottom: '16px' }}>
              <div style={{ fontWeight: '600', color: GREEN, marginBottom: '6px' }}>The Gross Margin Multiplier Effect</div>
              <p style={{ fontSize: '12px', marginBottom: '6px' }}>
                At 66% GM with 4.67x MER, NWDY generates <strong>$3.09 gross profit per $1 marketing spend</strong>.
              </p>
              <p style={{ fontSize: '12px' }}>
                A cohort peer with 35% GM would need <strong>MER of 5.0x</strong> to match this profitability. NWDY's high margins act as a 
                force multiplier on marketing efficiency.
              </p>
            </div>
            <p style={{ marginBottom: '24px' }}>
              pMER volatility (ranging from 1.4x to 4.3x monthly) suggests opportunity for optimization — understanding what drives the 
              high-pMER months (Apr, Sep) could unlock significant value.
            </p>

            <SectionHeader>7. Capital Strategy & Efficiency</SectionHeader>
            <p style={{ marginBottom: '16px' }}>
              NWDY has raised <strong>$9.1M</strong> in SAFE financing and deployed only <strong>$2.8M</strong> — preserving significant runway 
              with $3M+ in reserve. Capital efficiency of 3.0x (revenue/capital raised) reflects a lean operating philosophy.
            </p>
            <p style={{ marginBottom: '24px' }}>
              <strong style={{ color: GREEN }}>Growth Efficiency of 10.3</strong> (negative = capital-efficient) means NWDY generates cash while 
              growing — exceptional at this stage. Most cohort peers show positive growth efficiency, meaning they consume cash to grow.
            </p>

            <SectionHeader>8. Summary Observations</SectionHeader>
            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px', marginBottom: '24px' }}>
              <div style={{ backgroundColor: LIGHT_GREEN, padding: '12px', borderRadius: '6px' }}>
                <div style={{ fontWeight: '600', color: GREEN, marginBottom: '8px' }}>Exceptional Outperformance</div>
                <ul style={{ margin: 0, paddingLeft: '16px', fontSize: '12px' }}>
                  <li>EBITDA +9 pts above cohort</li>
                  <li>Net Income +5 pts above cohort</li>
                  <li>G&A 21 pts leaner than cohort</li>
                  <li>Cash generative while growing</li>
                  <li>pMER of 3.09x (profitable acquisition)</li>
                  <li>Reached milestone 2x faster</li>
                </ul>
              </div>
              <div style={{ backgroundColor: LIGHT_AMBER, padding: '12px', borderRadius: '6px' }}>
                <div style={{ fontWeight: '600', color: AMBER, marginBottom: '8px' }}>Areas to Monitor</div>
                <ul style={{ margin: 0, paddingLeft: '16px', fontSize: '12px' }}>
                  <li>Organizational maturity at 32 months from first revenue</li>
                  <li>G&A leanness may mask infrastructure gaps</li>
                  <li>Payroll at &lt;1/4 cohort (key person risk)</li>
                  <li>pMER volatility month-to-month</li>
                  <li>Ops costs (DTC structural)</li>
                  <li>Capital deployment strategy</li>
                </ul>
              </div>
            </div>

            <SectionHeader>9. Discussion Prompts</SectionHeader>
            <ol style={{ paddingLeft: '24px', marginBottom: 0 }}>
              <li style={{ marginBottom: '8px' }}><strong>Growth Investment:</strong> Would NWDY benefit from a modest increase in S&M to accelerate growth while maintaining efficiency — or is the current capital-light approach optimal?</li>
              <li style={{ marginBottom: '8px' }}><strong>pMER Optimization:</strong> What's driving pMER volatility (1.4x–4.3x)? Can high-pMER months be replicated?</li>
              <li style={{ marginBottom: '8px' }}><strong>Channel Strategy:</strong> Wholesale distribution offers significant growth opportunity, but requires substantially more working capital. Should the company leverage its gross margin strength to expand distribution?</li>
              <li><strong>Capital Deployment:</strong> With $3M+ in undeployed capital and positive cash flow, what's the right deployment strategy?</li>
            </ol>
          </div>
        </Card>
      </div>
    );

    // Page 7: Company Info
    const CompanyInfoPage = () => (
      <div className="print-page" style={{ padding: '20px 28px' }}>
        <Card>
          <div style={{ fontSize: '13px', lineHeight: '1.7', color: '#333' }}>
            
            <SectionHeader>Company Overview</SectionHeader>
            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '20px', marginBottom: '24px' }}>
              <div>
                <div style={{ fontWeight: '600', color: TEAL, marginBottom: '8px' }}>Business Profile</div>
                <table style={{ fontSize: '12px', width: '100%' }}>
                  <tbody>
                    <tr><td style={{ padding: '4px 0', color: '#666' }}>Legal Name</td><td style={{ padding: '4px 0' }}>Disruptive Beverage Inc. (NWDY)</td></tr>
                    <tr><td style={{ padding: '4px 0', color: '#666' }}>Brand</td><td style={{ padding: '4px 0' }}>NWDY</td></tr>
                    <tr><td style={{ padding: '4px 0', color: '#666' }}>Category</td><td style={{ padding: '4px 0' }}>Cannabis-Infused Spirits / Alt Beverages</td></tr>
                    <tr><td style={{ padding: '4px 0', color: '#666' }}>Business Model</td><td style={{ padding: '4px 0' }}>DTC-first with retail/wholesale expansion</td></tr>
                    <tr><td style={{ padding: '4px 0', color: '#666' }}>Year Founded</td><td style={{ padding: '4px 0' }}>2023 (launched April 2023)</td></tr>
                    <tr><td style={{ padding: '4px 0', color: '#666' }}>Entity Type</td><td style={{ padding: '4px 0' }}>Delaware C-Corp</td></tr>
                    <tr><td style={{ padding: '4px 0', color: '#666' }}>Headquarters</td><td style={{ padding: '4px 0' }}>Los Angeles, CA</td></tr>
                  </tbody>
                </table>
              </div>
              <div>
                <div style={{ fontWeight: '600', color: TEAL, marginBottom: '8px' }}>One-Liner</div>
                <p style={{ fontSize: '12px', fontStyle: 'italic', marginBottom: '16px' }}>
                  "Put a new spin on drinking - cannabis-infused spirits as a sophisticated alcohol alternative"
                </p>
                <div style={{ fontWeight: '600', color: TEAL, marginBottom: '8px' }}>Key Product</div>
                <p style={{ fontSize: '12px' }}>
                  Hemp-derived Delta-9 THC spirits ($39.99-$59.99). Three dosage tiers. RTD canned cocktails. Ships DTC to 40+ states.
                </p>
              </div>
            </div>

            <SectionHeader>Leadership</SectionHeader>
            <div style={{ marginBottom: '24px' }}>
              <div style={{ backgroundColor: LIGHT_TEAL, padding: '12px', borderRadius: '6px', marginBottom: '12px' }}>
                <div style={{ fontWeight: '600', color: TEAL }}>Justin Tidwell * Founder & CEO</div>
                <p style={{ fontSize: '12px', margin: '8px 0 0 0' }}>
                  University of Arizona (2017). Previously at Green Rush Packaging. Forbes 30 Under 30 Food & Drink 2024. 
                </p>
              </div>
              <div style={{ backgroundColor: LIGHT_TEAL, padding: '12px', borderRadius: '6px' }}>
                <div style={{ fontWeight: '600', color: TEAL }}>Anthony Puterman * Co-Founder</div>
                <p style={{ fontSize: '12px', margin: '8px 0 0 0' }}>
                  CFO & Co-Founder. Forbes 30 Under 30 Food & Drink 2024. Leads finance and operations.
                </p>
              </div>
            </div>

            <SectionHeader>Capital History <span style={{ fontWeight: '400', fontSize: '11px', color: '#666' }}>(publicly disclosed)</span></SectionHeader>
            <table style={{ fontSize: '12px', width: '100%', marginBottom: '24px', borderCollapse: 'collapse' }}>
              <thead>
                <tr style={{ borderBottom: `2px solid ${GOLD}` }}>
                  <th style={{ padding: '8px', textAlign: 'left', color: TEAL }}>Round</th>
                  <th style={{ padding: '8px', textAlign: 'left', color: TEAL }}>Date</th>
                  <th style={{ padding: '8px', textAlign: 'right', color: TEAL }}>Amount</th>
                  <th style={{ padding: '8px', textAlign: 'left', color: TEAL }}>Lead Investor(s)</th>
                </tr>
              </thead>
              <tbody>
                <tr><td style={{ padding: '6px 8px' }}>Seed</td><td style={{ padding: '6px 8px' }}>2022-2024</td><td style={{ padding: '6px 8px', textAlign: 'right' }}>$10M+</td><td style={{ padding: '6px 8px' }}>Friends & Family</td></tr>
                <tr style={{ backgroundColor: '#f9f9f9' }}><td style={{ padding: '6px 8px' }}>Seed</td><td style={{ padding: '6px 8px' }}>2022-2024</td><td style={{ padding: '6px 8px', textAlign: 'right' }}>$10M+</td><td style={{ padding: '6px 8px' }}>Palm Tree Crew (DJ Kygo)</td></tr>
                <tr><td style={{ padding: '6px 8px' }}>Series A</td><td style={{ padding: '6px 8px' }}>2022-2024</td><td style={{ padding: '6px 8px', textAlign: 'right' }}>$10M+</td><td style={{ padding: '6px 8px' }}>Palm Tree Crew (DJ Kygo)</td></tr>
                <tr style={{ fontWeight: '600', borderTop: `2px solid ${GOLD}` }}><td style={{ padding: '8px' }}>Total Raised</td><td style={{ padding: '8px' }}></td><td style={{ padding: '8px', textAlign: 'right' }}>~$10M+</td><td style={{ padding: '8px' }}></td></tr>
              </tbody>
            </table>

            <SectionHeader>Stage Context</SectionHeader>
            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px', marginBottom: '24px' }}>
              <div style={{ backgroundColor: LIGHT_TEAL, padding: '12px', borderRadius: '6px' }}>
                <div style={{ fontWeight: '600', color: TEAL, marginBottom: '8px' }}>Timeline</div>
                <table style={{ fontSize: '12px', width: '100%' }}>
                  <tbody>
                    <tr><td style={{ padding: '4px 0', color: '#666' }}>Months Since Inception</td><td style={{ padding: '4px 0', fontWeight: '600' }}>~44 months (founded 2022)</td></tr>
                    <tr><td style={{ padding: '4px 0', color: '#666' }}>Months Since First Revenue*</td><td style={{ padding: '4px 0', fontWeight: '600' }}>~32 months (from Apr 2023)</td></tr>
                    <tr><td style={{ padding: '4px 0', color: '#666' }}>Pre-Revenue R&D Phase</td><td style={{ padding: '4px 0', fontWeight: '600' }}>Minimal pre-revenue period</td></tr>
                  </tbody>
                </table>
              </div>
              <div style={{ backgroundColor: LIGHT_AMBER, padding: '12px', borderRadius: '6px', border: `1px solid ${GOLD}` }}>
                <div style={{ fontWeight: '600', color: AMBER, marginBottom: '8px' }}>*  Data Quality Note</div>
                <p style={{ fontSize: '11px', marginBottom: '8px' }}>
                  Analysis uses Jun-Jul-Aug 2025. September excluded (not closed at data pull).
                </p>
                <p style={{ fontSize: '11px', marginBottom: '8px' }}>
                  *[Explain any asterisk on time metrics * e.g., pre-launch activity excluded from commercial first revenue.]
                </p>
                <p style={{ fontSize: '11px', margin: 0 }}>
                  <strong>"Months from first revenue"</strong> = months from first revenue recorded in GL.
                </p>
              </div>
            </div>

            <SectionHeader>RMF Cohort Selection</SectionHeader>
            <div style={{ backgroundColor: '#f5f5f5', padding: '16px', borderRadius: '6px' }}>
              <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '20px' }}>
                <div>
                  <div style={{ fontWeight: '600', color: TEAL, marginBottom: '8px' }}>Cohort Assigned</div>
                  <p style={{ fontSize: '12px', marginBottom: '4px' }}><strong>$60M Milestone * Top-Decile Cohort</strong></p>
                  <p style={{ fontSize: '11px', color: '#666' }}>Top-decile performers at this revenue stage</p>
                </div>
                <div>
                  <div style={{ fontWeight: '600', color: TEAL, marginBottom: '8px' }}>Selection Rationale</div>
                  <ul style={{ fontSize: '11px', margin: 0, paddingLeft: '16px', color: '#666' }}>
                    <li>Consumer beverage / CPG</li>
                    <li>DTC-first with retail expansion</li>
                    <li>Series A funded, growth stage</li>
                    <li>~$58M annualized run rate</li>
                  </ul>
                </div>
              </div>
            </div>

          </div>
        </Card>
      </div>
    );

    // ============================================================================
    // MAIN DASHBOARD
    // ============================================================================
    const Dashboard = () => {
      const [activePage, setActivePage] = React.useState(1);
      const [isPrinting, setIsPrinting] = React.useState(false);

      const handlePrint = () => {
        setIsPrinting(true);
        setTimeout(() => {
          window.print();
          setIsPrinting(false);
        }, 100);
      };

      const pages = ['Overview', 'P&L Variance', 'Analytics', 'Efficiency', 'Trends', 'Narrative', 'Company Info'];

      return (
        <div style={{ minHeight: '100vh', backgroundColor: '#f5f5f5' }}>
          {/* Header */}
          <div className="print-header" style={{ 
            backgroundColor: TEAL, 
            color: 'white', 
            padding: '20px 28px',
            display: 'flex',
            justifyContent: 'space-between',
            alignItems: 'center'
          }}>
            <div>
              <div style={{ fontSize: '10px', opacity: 0.7, letterSpacing: '2px', marginBottom: '2px' }}>REVENUE MILESTONE FRAMEWORK</div>
              <div style={{ fontSize: '24px', fontWeight: 'bold' }}>{COMPANY.fullName}</div>
              <div style={{ fontSize: '12px', opacity: 0.8, marginTop: '2px' }}>{COMPANY.milestone} Milestone Cohort Comparison</div>
            </div>
            <div style={{ textAlign: 'right' }}>
              <div style={{ fontSize: '10px', opacity: 0.7, letterSpacing: '1px' }}>PROPELLER INDUSTRIES</div>
              <div style={{ fontSize: '9px', opacity: 0.6, marginTop: '2px' }}>Financial Operating Platform</div>
              <div style={{ fontSize: '9px', opacity: 0.5, marginTop: '4px' }}>{COMPANY.analysisDate}</div>
            </div>
          </div>

          {/* Metrics Strip - Outlined style (Item 7) */}
          <div className="print-metrics" style={{ 
            display: 'flex', 
            gap: '10px', 
            padding: '16px 28px',
            backgroundColor: 'white',
            borderBottom: `3px solid ${GOLD}`
          }}>
            <MetricCard label="Net Revenue" value="$57.8M" subtext="annualized" performance="neutral" />
            <MetricCard label="Gross Margin" value="66.3%" subtext="vs 36.5% cohort" performance="neutral" />
            <MetricCard label="EBITDA" value="+5.6%" subtext="vs -53.5% cohort" performance="good" />
            <MetricCard label="Net Income" value="+5.7%" subtext="vs 5.3% cohort" performance="good" />
            <MetricCard label="YoY Growth" value="57.7%" subtext="vs 63.1% cohort" performance="bad" />
            <MetricCard label="pMER" value="3.09x" subtext="vs 1.0 breakeven" performance="good" />
            <MetricCard label="Time to Milestone" value="32 mo" subtext="vs 44 mo cohort" performance="good" />
          </div>

          {/* Navigation */}
          <div className="no-print" style={{ display: 'flex', gap: '8px', padding: '12px 28px', backgroundColor: '#eee', alignItems: 'center' }}>
            {pages.map((label, i) => (
              <button 
                key={i}
                onClick={() => setActivePage(i + 1)}
                style={{
                  padding: '8px 16px',
                  border: 'none',
                  borderRadius: '4px',
                  backgroundColor: activePage === i + 1 ? TEAL : 'white',
                  color: activePage === i + 1 ? 'white' : '#666',
                  fontSize: '12px',
                  fontWeight: '600',
                  cursor: 'pointer'
                }}
              >
                {label}
              </button>
            ))}
            <div style={{ flex: 1 }} />
            <button 
              onClick={handlePrint}
              style={{
                padding: '8px 16px',
                border: `1px solid ${TEAL}`,
                borderRadius: '4px',
                backgroundColor: 'white',
                color: TEAL,
                fontSize: '12px',
                fontWeight: '600',
                cursor: 'pointer'
              }}
            >
              🖨️ Print All
            </button>
          </div>

          {/* Page Content */}
          {isPrinting ? (
            <>
              <OverviewPage />
              <PLVariancePage />
              <AnalyticsPage />
              <EfficiencyPage />
              <TrendsPage />
              <NarrativePage />
              <CompanyInfoPage />
            </>
          ) : (
            <>
              {activePage === 1 && <OverviewPage />}
              {activePage === 2 && <PLVariancePage />}
              {activePage === 3 && <AnalyticsPage />}
              {activePage === 4 && <EfficiencyPage />}
              {activePage === 5 && <TrendsPage />}
              {activePage === 6 && <NarrativePage />}
              {activePage === 7 && <CompanyInfoPage />}
            </>
          )}

          {/* Footer */}
          <div className="print-footer" style={{ 
            padding: '14px 28px', 
            backgroundColor: LIGHT_TEAL,
            textAlign: 'center',
            marginTop: '12px'
          }}>
            <div style={{ fontSize: '11px', fontStyle: 'italic', color: TEAL }}>
              Powered by the Propeller Intelligence Engine (PIE) and Revenue Milestone Framework (RMF)
            </div>
            <div style={{ fontSize: '10px', color: '#666', marginTop: '2px' }}>
              Benchmarking context from 1,300+ companies
            </div>
          </div>
        </div>
      );
    };

    ReactDOM.render(<Dashboard />, document.getElementById('root'));
  </script>
</body>
</html>
